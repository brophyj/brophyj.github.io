<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jay Brophy">
<meta name="description" content="Can always find something positive if you look hard enough">
<title>What is the goal of this meta-analysis? – jay’s website</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../images/logo.png" rel="icon" type="image/png">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-234273d1456647dabc34a594ac50e507.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-1f7fd168c3a2bd1f3385ec7b3b313676.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<link rel="stylesheet" href="../../custom.scss">
<meta property="og:title" content="What is the goal of this meta-analysis? – jay’s website">
<meta property="og:description" content="Can always find something positive if you look hard enough">
<meta property="og:image" content="https://brophyj.com/posts/2025-11-27-Something_positive/preview-image.jpg">
<meta property="og:site_name" content="jay's website">
<meta name="twitter:title" content="What is the goal of this meta-analysis? – jay’s website">
<meta name="twitter:description" content="Can always find something positive if you look hard enough">
<meta name="twitter:image" content="https://brophyj.com/posts/2025-11-27-Something_positive/preview-image.jpg">
<meta name="twitter:card" content="summary_large_image">
</head>
<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner"><nav class="navbar navbar-expand-lg " data-bs-theme="dark"><div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/logo.png" alt="" class="navbar-logo"></a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">jay’s website</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
<li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../talks.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../example.html"> 
<span class="menu-text">Art</span></a>
  </li>  
</ul>
<ul class="navbar-nav navbar-nav-scroll ms-auto">
<li class="nav-item">
    <a class="nav-link" href="https://orcid.org/my-orcid?orcid=0000-0001-8049-6875"> 
<span class="menu-text"><i class="fab fa-orcid"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://mastodon.social/@brophyj"> 
<span class="menu-text"><i class="fab fa-mastodon"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://twitter.com/brophyj"> 
<span class="menu-text"><i class="fab fa-twitter"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://www.linkedin.com/in/brophyj/"> 
<span class="menu-text"><i class="fab fa-linkedin-in"></i></span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/brophyj"> 
<span class="menu-text"><i class="fab fa-github"></i></span></a>
  </li>  
</ul>
</div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-page">
      <div class="quarto-title-block"><div><h1 class="title">What is the goal of this meta-analysis?</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                  <div>
        <div class="description">
          Can always find something positive if you look hard enough
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">meta-analysis</div>
                <div class="quarto-category">bias</div>
              </div>
                  </div>
  </div>
    
  <div class="quarto-title-meta-author column-page">
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-heading">Affiliation</div>
    
      <div class="quarto-title-meta-contents">
      <p class="author"><a href="https://brophyj.github.io/">Jay Brophy</a> <a href="https://orcid.org/0000-0001-8049-6875" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
    </div>
    <div class="quarto-title-meta-contents">
          <p class="affiliation">
              <a href="https://mcgill.ca">
              McGill University Dept Medince, Epidemiology &amp; Biostatistics
              </a>
            </p>
        </div>
    </div>

  <div class="quarto-title-meta column-page">

        
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">Thursday, the 27th of November, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block column-page" id="quarto-document-content"><section id="recent-article---background" class="level2"><h2 class="anchored" data-anchor-id="recent-article---background">Recent article - Background</h2>
<p>A recent meta-analysis<span class="citation" data-cites="RN2">(<a href="#ref-RN2" role="doc-biblioref">Abdelaziz et al. 2025</a>)</span> concluded “Males with high-volume exercise training (&gt;3,000 MET-min/wk) exhibited a higher burden of calcified plaque by CAC score than male nonathletes, while no such difference was observed in female athletes.” Apart from the surprising observation of a positive association of increased exercise and increased cardiovascular risk factors, one is left wondering what was the original objective of this study. Perhaps a look at the pre-registered protocol (https://www.crd.york.ac.uk/PROSPERO/view/CRD42024573617) can help. Here the main outcome is stated</p>
<blockquote class="blockquote">
<p>The primary outcome of interest was analysis of coronary artery calcium (CAC) score (between athletes and non-athletes).</p>
</blockquote>
<p>There is no mention of preplanned analyses according to sex of either the primary or any secondary outcome. Of course, results from post hoc analyses carry less inferential validity.</p>
<p>Even ignoring the apparent post hoc nature of the analysis, how should these results be interpreted? How can they be sensibly interpreted without an idea of the prior probability that women would behave differently than men or that heavy exercising men would behave worse than moderately exercising men?<br>
Even ignoring the lack of prior probabilities, does the data show as contended by the authors that male athletes engaging in high-volume exercise compared to nonathletes have higher CAC scores than athletes with moderate volume exercise compared to nonathletes. The CAC values for male athletes compared to nonathletes was 1.2 (95% CI -24.66 to 27.05, p = 0.9) for &lt; 3000 group and 31.62 (95% 10.66 to 52.58, p = 0.003) for group &gt; 3000. Are these differences statistically significant?</p>
<p>The fallacy of simply comparing significance levels has been well described in several publications <span class="citation" data-cites="RN7649 RN5623">(<a href="#ref-RN7649" role="doc-biblioref">Gelman and Stern 2006</a>; <a href="#ref-RN5623" role="doc-biblioref">Altman and Bland 2003</a>)</span>. Testing for the statistical significance of the difference between two independent estimates is required to determine if they are statistically different and is easily implemented by calculating the risk difference and its confidence interval and p-value, as shown in the following code.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co">###############</span></span>
<span><span class="co"># Interaction test for risk ratio RR</span></span>
<span><span class="co">###############</span></span>
<span></span>
<span><span class="va">inter_test</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rr1</span>, <span class="va">rr1LL</span>, <span class="va">rr1UL</span>, <span class="va">rr2</span>, <span class="va">rr2LL</span>, <span class="va">rr2UL</span>, <span class="va">sig</span><span class="op">=</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">logSE1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">rr1UL</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">rr1LL</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span><span class="op">)</span> <span class="co">#se of log(rr1), default 95%CI, sig = 1 sided value</span></span>
<span>  <span class="va">logSE2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">rr2UL</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">rr2LL</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span><span class="op">)</span> <span class="co">#se of log(rr1)</span></span>
<span>  <span class="va">diffLogRR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">rr1</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">rr2</span><span class="op">)</span> <span class="co">#diff of log rr</span></span>
<span>  <span class="va">logRR_SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">logSE1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">logSE2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co">#log (se) of differences</span></span>
<span>  <span class="va">logRR_UCI</span> <span class="op">&lt;-</span> <span class="va">diffLogRR</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span> <span class="op">*</span> <span class="va">logRR_SE</span></span>
<span>  <span class="va">logRR_LCI</span> <span class="op">&lt;-</span> <span class="va">diffLogRR</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span> <span class="op">*</span> <span class="va">logRR_SE</span></span>
<span>  <span class="va">RR</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">diffLogRR</span><span class="op">)</span> <span class="co"># RR point estimate</span></span>
<span>  <span class="va">RR_UCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">logRR_UCI</span><span class="op">)</span> <span class="co"># RR upper CI</span></span>
<span>  <span class="va">RR_LCI</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="va">logRR_LCI</span><span class="op">)</span> <span class="co"># RR lower CI</span></span>
<span>  <span class="va">RR_SE</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">RR_UCI</span> <span class="op">-</span> <span class="va">RR_LCI</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fl">1.96</span><span class="op">)</span></span>
<span>  <span class="va">z</span> <span class="op">&lt;-</span> <span class="va">diffLogRR</span> <span class="op">/</span> <span class="va">logRR_SE</span></span>
<span>  <span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#p value for the interaction term</span></span>
<span>  <span class="va">state1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"The relative risk for the interaction is "</span>, <span class="va">RR</span>, <span class="st">", 95% CI "</span>, <span class="va">RR_LCI</span>, <span class="st">" - "</span>, <span class="va">RR_UCI</span>, <span class="st">" and p value ="</span> , <span class="va">pvalue</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">###############</span></span>
<span><span class="co"># Interaction test for risk difference #</span></span>
<span><span class="co">###############</span></span>
<span></span>
<span><span class="va">inter_test_rd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">rd1</span>, <span class="va">rd1LL</span>, <span class="va">rd1UL</span>, <span class="va">rd2</span>, <span class="va">rd2LL</span>, <span class="va">rd2UL</span>, <span class="va">sig</span><span class="op">=</span><span class="fl">0.975</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">se1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">rd1UL</span> <span class="op">-</span> <span class="va">rd1LL</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span><span class="op">)</span> <span class="co">#se of risk difference 1</span></span>
<span>  <span class="va">se2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">rd2UL</span> <span class="op">-</span> <span class="va">rd2LL</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span><span class="op">)</span> <span class="co">#se of risk difference 2</span></span>
<span>  <span class="va">diffRD</span> <span class="op">&lt;-</span> <span class="va">rd1</span> <span class="op">-</span> <span class="va">rd2</span> <span class="co">#diff of risk difference</span></span>
<span>  <span class="va">RD_SE</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">se1</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">se2</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co">#se of differences</span></span>
<span>  <span class="va">RD_UCI</span> <span class="op">&lt;-</span> <span class="va">diffRD</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span> <span class="op">*</span> <span class="va">RD_SE</span></span>
<span>  <span class="va">RD_LCI</span> <span class="op">&lt;-</span> <span class="va">diffRD</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span><span class="op">(</span><span class="va">sig</span><span class="op">)</span> <span class="op">*</span> <span class="va">RD_SE</span></span>
<span>  <span class="va">pvalue</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">diffRD</span><span class="op">/</span><span class="va">RD_SE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co">#p value for the interaction term</span></span>
<span>  <span class="co"># cat("The risk difference for the interaction is ", diffRD, ", 95% CI ", RD_LCI, " - ", RD_UCI, " and p value =" , pvalue)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>diffRD <span class="op">=</span> <span class="va">diffRD</span>, RD_LCI <span class="op">=</span> <span class="va">RD_LCI</span>, RD_UCI <span class="op">=</span> <span class="va">RD_UCI</span>, pvalue <span class="op">=</span> <span class="va">pvalue</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">rd_out</span> <span class="op">&lt;-</span> <span class="fu">inter_test_rd</span><span class="op">(</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">24.66</span>, <span class="fl">27.05</span>, <span class="fl">31.62</span>, <span class="fl">10.66</span>, <span class="fl">52.58</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The risk difference for the interaction is -30.42, (95% CI -63.7 to 2.86, p = 0.07). The key insight being “In making a comparison between two group, one should look at the statistical significance of the difference rather than the difference between their significance levels”<span class="citation" data-cites="RN7649">(<a href="#ref-RN7649" role="doc-biblioref">Gelman and Stern 2006</a>)</span>. Thus, there is no statistical evidence of a difference in CAC values between male athletes engaging in high-volume exercise compared to nonathletes and male athletes with moderate volume exercise compared to nonathletes. This becomes more evident if the forest plots (Bayesian with vague priors) are recreated with the prediction intervals showing the considerable overalp in the predcited next study for the subgroups.</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># men</span></span>
<span><span class="co"># ---- Packages ----</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/cmdstanr/">cmdstanr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Data (extracted from your figure) ----</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">group</span>,        <span class="op">~</span><span class="va">study</span>,               <span class="op">~</span><span class="va">yi</span>,   <span class="op">~</span><span class="va">lower</span>,   <span class="op">~</span><span class="va">upper</span>,</span>
<span>  <span class="st">"1500-3000"</span>,   <span class="st">"Aengevaeren 2017"</span>,   <span class="fl">11.50</span>,   <span class="fl">2.92</span>,   <span class="fl">20.08</span>,</span>
<span>  <span class="st">"1500-3000"</span>,   <span class="st">"Pavlovic 2024"</span>,      <span class="fl">16.50</span>,  <span class="op">-</span><span class="fl">0.16</span>,   <span class="fl">33.16</span>,</span>
<span>  <span class="st">"1500-3000"</span>,   <span class="st">"Defina 2019"</span>,       <span class="op">-</span><span class="fl">27.12</span>, <span class="op">-</span><span class="fl">47.05</span>,   <span class="op">-</span><span class="fl">6.99</span>,</span>
<span>  <span class="st">"&gt;3000"</span>,       <span class="st">"Bosscher 2023"</span>,      <span class="fl">19.80</span>,   <span class="fl">8.84</span>,   <span class="fl">30.76</span>,</span>
<span>  <span class="st">"&gt;3000"</span>,       <span class="st">"Mohlenkamp 2008"</span>,     <span class="fl">9.08</span>, <span class="op">-</span><span class="fl">18.88</span>,   <span class="fl">37.04</span>,</span>
<span>  <span class="st">"&gt;3000"</span>,       <span class="st">"Pavlovic 2024"</span>,      <span class="fl">25.06</span>,  <span class="fl">13.55</span>,   <span class="fl">37.57</span>,</span>
<span>  <span class="st">"&gt;3000"</span>,       <span class="st">"Defina 2019"</span>,        <span class="fl">42.50</span>,  <span class="fl">12.08</span>,   <span class="fl">72.92</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    sei <span class="op">=</span> <span class="op">(</span><span class="va">upper</span> <span class="op">-</span> <span class="va">lower</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.96</span><span class="op">)</span>,</span>
<span>    study <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1500-3000"</span>, <span class="st">"&gt;3000"</span><span class="op">)</span><span class="op">)</span> <span class="co"># explicit subgroup order</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Priors: vague but weakly informative ----</span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>,              <span class="co"># mu ~ N(0, 50^2)</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">student_t</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sd"</span>, group <span class="op">=</span> <span class="st">"study"</span><span class="op">)</span><span class="co"># tau ~ t(3,0,10)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Fit models ----</span></span>
<span><span class="va">fit_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">sei</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>               data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>               prior <span class="op">=</span> <span class="va">priors</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>,</span>
<span>               iter <span class="op">=</span> <span class="fl">4000</span>, chains <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the model object to disk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit_all</span>, file <span class="op">=</span> <span class="st">"model/fit_all.rds"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fit_1500</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">sei</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"1500-3000"</span><span class="op">)</span>,</span>
<span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>                backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">4000</span>, chains <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit_all</span>, file <span class="op">=</span> <span class="st">"model/fit_1500.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_3000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">sei</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"&gt;3000"</span><span class="op">)</span>,</span>
<span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>                backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">4000</span>, chains <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit_all</span>, file <span class="op">=</span> <span class="st">"model/fit_3000.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Posterior draws ----</span></span>
<span><span class="va">draws_all</span> <span class="op">&lt;-</span> <span class="va">fit_all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">b_Intercept</span>, <span class="va">sd_study__Intercept</span><span class="op">)</span></span>
<span><span class="va">draws_1</span>   <span class="op">&lt;-</span> <span class="va">fit_1500</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">b_Intercept</span>, <span class="va">sd_study__Intercept</span><span class="op">)</span></span>
<span><span class="va">draws_2</span>   <span class="op">&lt;-</span> <span class="va">fit_3000</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">b_Intercept</span>, <span class="va">sd_study__Intercept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Summaries (μ and τ) ----</span></span>
<span><span class="va">summarise_mu_tau</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    mu_median  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span><span class="op">)</span>,</span>
<span>    mu_low     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    mu_high    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>    tau_median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span><span class="op">)</span>,</span>
<span>    tau_low    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    tau_high   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">summ_all</span> <span class="op">&lt;-</span> <span class="fu">summarise_mu_tau</span><span class="op">(</span><span class="va">draws_all</span><span class="op">)</span></span>
<span><span class="va">summ_1</span>   <span class="op">&lt;-</span> <span class="fu">summarise_mu_tau</span><span class="op">(</span><span class="va">draws_1</span><span class="op">)</span></span>
<span><span class="va">summ_2</span>   <span class="op">&lt;-</span> <span class="fu">summarise_mu_tau</span><span class="op">(</span><span class="va">draws_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Prediction intervals (new TRUE study effect) ----</span></span>
<span><span class="va">summarise_pred</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">theta_new</span> <span class="op">&lt;-</span> <span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    pred_low  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">theta_new</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    pred_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">theta_new</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">pi_all</span> <span class="op">&lt;-</span> <span class="fu">summarise_pred</span><span class="op">(</span><span class="va">draws_all</span><span class="op">)</span></span>
<span><span class="va">pi_1</span>   <span class="op">&lt;-</span> <span class="fu">summarise_pred</span><span class="op">(</span><span class="va">draws_1</span><span class="op">)</span></span>
<span><span class="va">pi_2</span>   <span class="op">&lt;-</span> <span class="fu">summarise_pred</span><span class="op">(</span><span class="va">draws_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Build plotting rows with exact order ----</span></span>
<span><span class="co"># Desired order from TOP to BOTTOM:</span></span>
<span><span class="co"># 1) Subgroup "1500-3000": its studies (top), then "1500-3000 Pooled", then "1500-3000 Predicted"</span></span>
<span><span class="co">#    then a GAP</span></span>
<span><span class="co"># 2) Subgroup "&gt;3000":     its studies, then "&gt;3000 Pooled", then "&gt;3000 Predicted"</span></span>
<span><span class="co">#    then a GAP</span></span>
<span><span class="co"># 3) Overall:              "Overall Pooled", then "Overall Predicted" (very bottom)</span></span>
<span></span>
<span><span class="co"># Helper to make study rows</span></span>
<span><span class="va">make_study_rows</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dsub</span>, <span class="va">label_group</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dsub</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      lab   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">study</span>, <span class="st">" ("</span>, <span class="va">label_group</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>      type  <span class="op">=</span> <span class="st">"study"</span>,</span>
<span>      xmin  <span class="op">=</span> <span class="va">lower</span>, x <span class="op">=</span> <span class="va">yi</span>, xmax <span class="op">=</span> <span class="va">upper</span>,</span>
<span>      col   <span class="op">=</span> <span class="st">"#1f77b4"</span>, shape <span class="op">=</span> <span class="cn">NA_real_</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">lab</span>, <span class="va">type</span>, <span class="va">xmin</span>, <span class="va">x</span>, <span class="va">xmax</span>, <span class="va">col</span>, <span class="va">shape</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Helper to make pooled + predicted rows (in that order)</span></span>
<span><span class="va">make_summary_rows</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">summ</span>, <span class="va">pi</span>, <span class="va">label_group</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pooled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    lab   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">label_group</span>, <span class="st">" Pooled"</span><span class="op">)</span>,</span>
<span>    type  <span class="op">=</span> <span class="st">"pooled"</span>,</span>
<span>    xmin  <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_low</span>, x <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_median</span>, xmax <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_high</span>,</span>
<span>    col   <span class="op">=</span> <span class="st">"darkred"</span>, shape <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    lab   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">label_group</span>, <span class="st">" Predicted"</span><span class="op">)</span>,</span>
<span>    type  <span class="op">=</span> <span class="st">"predicted"</span>,</span>
<span>    xmin  <span class="op">=</span> <span class="va">pi</span><span class="op">$</span><span class="va">pred_low</span>, x <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_median</span>, xmax <span class="op">=</span> <span class="va">pi</span><span class="op">$</span><span class="va">pred_high</span>,</span>
<span>    col   <span class="op">=</span> <span class="st">"orange"</span>, shape <span class="op">=</span> <span class="fl">17</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">pooled</span>, <span class="va">predicted</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">rows_top_to_bottom</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="co"># Subgroup 1500–3000 block</span></span>
<span>  <span class="fu">make_study_rows</span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"1500-3000"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span><span class="op">)</span>, <span class="st">"1500-3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu">make_summary_rows</span><span class="op">(</span><span class="va">summ_1</span>, <span class="va">pi_1</span>, <span class="st">"1500-3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"gap"</span>, xmin <span class="op">=</span> <span class="cn">NA</span>, x <span class="op">=</span> <span class="cn">NA</span>, xmax <span class="op">=</span> <span class="cn">NA</span>, col <span class="op">=</span> <span class="cn">NA</span>, shape <span class="op">=</span> <span class="cn">NA_real_</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># Subgroup &gt;3000 block</span></span>
<span>  <span class="fu">make_study_rows</span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"&gt;3000"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span><span class="op">)</span>, <span class="st">"&gt;3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu">make_summary_rows</span><span class="op">(</span><span class="va">summ_2</span>, <span class="va">pi_2</span>, <span class="st">"&gt;3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"gap"</span>, xmin <span class="op">=</span> <span class="cn">NA</span>, x <span class="op">=</span> <span class="cn">NA</span>, xmax <span class="op">=</span> <span class="cn">NA</span>, col <span class="op">=</span> <span class="cn">NA</span>, shape <span class="op">=</span> <span class="cn">NA_real_</span><span class="op">)</span>,</span>
<span></span>
<span>  <span class="co"># Overall at very bottom: pooled then predicted</span></span>
<span>  <span class="fu">make_summary_rows</span><span class="op">(</span><span class="va">summ_all</span>, <span class="va">pi_all</span>, <span class="st">"Overall"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rows_top_to_bottom</span> <span class="op">&lt;-</span> <span class="va">rows_top_to_bottom</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>row_id <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">row_id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbarh</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"study"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"#1f77b4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"study"</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"#1f77b4"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbarh</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"pooled"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"pooled"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shape</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbarh</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"predicted"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"predicted"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shape</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"pooled"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xmax</span> <span class="op">+</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="st">"Pooled"</span><span class="op">)</span>,</span>
<span>            hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">3.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"predicted"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xmax</span> <span class="op">+</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="st">"Predicted"</span><span class="op">)</span>,</span>
<span>            hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">3.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="va">rows_top_to_bottom</span><span class="op">$</span><span class="va">y</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">rows_top_to_bottom</span><span class="op">$</span><span class="va">lab</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`15` <span class="op">=</span> <span class="fl">15</span>, `17` <span class="op">=</span> <span class="fl">17</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Mean difference"</span>, y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Forest plot: CACs cores in male athletes engaging in different volumes of exercise"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Points and horizontal lines represent posterior medians and 95% credible intervals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Save plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"images/male_forest_plot.png"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7.5</span>, height <span class="op">=</span> <span class="fl">8.5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"images/male_forest_plot.pdf"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7.5</span>, height <span class="op">=</span> <span class="fl">8.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><a href="images/male_forest_plot.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="images/male_forest_plot.png" class="img-fluid"></a></p>
<p>What if the authors had followed their protocol and examined CAC scores in all athletes compared to nonathletes?</p>
<div class="cell">
<details class="code-fold"><summary>Code</summary><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ---- Packages ----</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/paul-buerkner/brms">brms</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mjskay.github.io/tidybayes/">tidybayes</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/cmdstanr/">cmdstanr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span>mc.cores <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html">detectCores</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Data (extracted from your figure) ----</span></span>
<span></span>
<span><span class="co"># ---- Data (COMBINED Male + Female) ----</span></span>
<span></span>
<span><span class="co"># ---- Data (COMBINED Male + Female, grouped) ----</span></span>
<span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">group</span>,        <span class="op">~</span><span class="va">study</span>,               <span class="op">~</span><span class="va">yi</span>,    <span class="op">~</span><span class="va">lower</span>,    <span class="op">~</span><span class="va">upper</span>,</span>
<span>  <span class="st">"1500-3000"</span>,   <span class="st">"Aengevaeren 2017"</span>,   <span class="op">-</span><span class="fl">1.75</span>,  <span class="op">-</span><span class="fl">13.54</span>,    <span class="fl">10.04</span>,</span>
<span>  <span class="st">"1500-3000"</span>,   <span class="st">"Pavlovic 2024"</span>,      <span class="fl">13.25</span>,   <span class="op">-</span><span class="fl">2.58</span>,    <span class="fl">29.08</span>,</span>
<span>  <span class="st">"1500-3000"</span>,   <span class="st">"Defina 2019"</span>,       <span class="op">-</span><span class="fl">23.56</span>,  <span class="op">-</span><span class="fl">43.53</span>,    <span class="op">-</span><span class="fl">3.50</span>,</span>
<span>  <span class="st">"&gt;3000"</span>,       <span class="st">"Bosscher 2023"</span>,      <span class="fl">17.40</span>,    <span class="fl">4.42</span>,    <span class="fl">30.38</span>,</span>
<span>  <span class="st">"&gt;3000"</span>,       <span class="st">"Mohlenkamp 2008"</span>,     <span class="fl">7.04</span>,  <span class="op">-</span><span class="fl">14.44</span>,    <span class="fl">28.52</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    sei <span class="op">=</span> <span class="op">(</span><span class="va">upper</span> <span class="op">-</span> <span class="va">lower</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="fl">1.96</span><span class="op">)</span>,</span>
<span>    study <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span>,</span>
<span>    group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">group</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"1500-3000"</span>, <span class="st">"&gt;3000"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>    </span>
<span></span>
<span><span class="co"># ---- Priors: vague but weakly informative ----</span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">0</span>, <span class="fl">50</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span>,              <span class="co"># mu ~ N(0, 50^2)</span></span>
<span>  <span class="fu"><a href="https://paulbuerkner.com/brms/reference/set_prior.html">prior</a></span><span class="op">(</span><span class="fu">student_t</span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>, class <span class="op">=</span> <span class="st">"sd"</span>, group <span class="op">=</span> <span class="st">"study"</span><span class="op">)</span><span class="co"># tau ~ t(3,0,10)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Fit models ----</span></span>
<span><span class="va">fit_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">sei</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>               data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>               prior <span class="op">=</span> <span class="va">priors</span>, backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, </span>
<span>               iter <span class="op">=</span> <span class="fl">4000</span>, chains <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">123</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save the model object to disk</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit_all</span>, file <span class="op">=</span> <span class="st">"model/combined_all.rds"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">fit_1500</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">sei</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"1500-3000"</span><span class="op">)</span>,</span>
<span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>                backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">4000</span>, chains <span class="op">=</span> <span class="fl">4</span>, seed <span class="op">=</span> <span class="fl">123</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit_all</span>, file <span class="op">=</span> <span class="st">"model/combined_1500.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_3000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/brm.html">brm</a></span><span class="op">(</span><span class="va">yi</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">sei</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>                data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">df</span>, <span class="va">group</span> <span class="op">==</span> <span class="st">"&gt;3000"</span><span class="op">)</span>,</span>
<span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html">gaussian</a></span><span class="op">(</span><span class="op">)</span>, prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>                backend <span class="op">=</span> <span class="st">"cmdstanr"</span>, iter <span class="op">=</span> <span class="fl">4000</span>, chains <span class="op">=</span> <span class="fl">4</span>, refresh <span class="op">=</span> <span class="fl">0</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">saveRDS</a></span><span class="op">(</span><span class="va">fit_all</span>, file <span class="op">=</span> <span class="st">"model/combined_3000.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fit_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"model/combined_all.rds"</span><span class="op">)</span></span>
<span><span class="va">fit_1500</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"model/combined_1500.rds"</span><span class="op">)</span></span>
<span><span class="va">fit_3000</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html">readRDS</a></span><span class="op">(</span><span class="st">"model/combined_3000.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Posterior draws ----</span></span>
<span><span class="va">draws_all</span> <span class="op">&lt;-</span> <span class="va">fit_all</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">b_Intercept</span>, <span class="va">sd_study__Intercept</span><span class="op">)</span></span>
<span><span class="va">draws_1</span>   <span class="op">&lt;-</span> <span class="va">fit_1500</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">b_Intercept</span>, <span class="va">sd_study__Intercept</span><span class="op">)</span></span>
<span><span class="va">draws_2</span>   <span class="op">&lt;-</span> <span class="va">fit_3000</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html">spread_draws</a></span><span class="op">(</span><span class="va">b_Intercept</span>, <span class="va">sd_study__Intercept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Summaries (μ and τ) ----</span></span>
<span><span class="va">summarise_mu_tau</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    mu_median  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span><span class="op">)</span>,</span>
<span>    mu_low     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    mu_high    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span>, <span class="fl">0.975</span><span class="op">)</span>,</span>
<span>    tau_median <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span><span class="op">)</span>,</span>
<span>    tau_low    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    tau_high   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">summ_all</span> <span class="op">&lt;-</span> <span class="fu">summarise_mu_tau</span><span class="op">(</span><span class="va">draws_all</span><span class="op">)</span></span>
<span><span class="va">summ_1</span>   <span class="op">&lt;-</span> <span class="fu">summarise_mu_tau</span><span class="op">(</span><span class="va">draws_1</span><span class="op">)</span></span>
<span><span class="va">summ_2</span>   <span class="op">&lt;-</span> <span class="fu">summarise_mu_tau</span><span class="op">(</span><span class="va">draws_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Prediction intervals (new TRUE study effect) ----</span></span>
<span><span class="va">summarise_pred</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dr</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">theta_new</span> <span class="op">&lt;-</span> <span class="va">dr</span><span class="op">$</span><span class="va">b_Intercept</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">dr</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="va">dr</span><span class="op">$</span><span class="va">sd_study__Intercept</span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    pred_low  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">theta_new</span>, <span class="fl">0.025</span><span class="op">)</span>,</span>
<span>    pred_high <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">theta_new</span>, <span class="fl">0.975</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="va">pi_all</span> <span class="op">&lt;-</span> <span class="fu">summarise_pred</span><span class="op">(</span><span class="va">draws_all</span><span class="op">)</span></span>
<span><span class="va">pi_1</span>   <span class="op">&lt;-</span> <span class="fu">summarise_pred</span><span class="op">(</span><span class="va">draws_1</span><span class="op">)</span></span>
<span><span class="va">pi_2</span>   <span class="op">&lt;-</span> <span class="fu">summarise_pred</span><span class="op">(</span><span class="va">draws_2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># ---- Build plotting rows with exact order ----</span></span>
<span><span class="co"># Desired order from TOP to BOTTOM:</span></span>
<span><span class="co"># 1) Subgroup "1500-3000": its studies (top), then "1500-3000 Pooled", then "1500-3000 Predicted"</span></span>
<span><span class="co">#    then a GAP</span></span>
<span><span class="co"># 2) Subgroup "&gt;3000":     its studies, then "&gt;3000 Pooled", then "&gt;3000 Predicted"</span></span>
<span><span class="co">#    then a GAP</span></span>
<span><span class="co"># 3) Overall:              "Overall Pooled", then "Overall Predicted" (very bottom)</span></span>
<span></span>
<span><span class="co"># Helper to make study rows</span></span>
<span><span class="va">make_study_rows</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dsub</span>, <span class="va">label_group</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">dsub</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>      lab   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">study</span>, <span class="st">" ("</span>, <span class="va">label_group</span>, <span class="st">")"</span><span class="op">)</span>,</span>
<span>      type  <span class="op">=</span> <span class="st">"study"</span>,</span>
<span>      xmin  <span class="op">=</span> <span class="va">lower</span>, x <span class="op">=</span> <span class="va">yi</span>, xmax <span class="op">=</span> <span class="va">upper</span>,</span>
<span>      col   <span class="op">=</span> <span class="st">"#1f77b4"</span>, shape <span class="op">=</span> <span class="cn">NA_real_</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">lab</span>, <span class="va">type</span>, <span class="va">xmin</span>, <span class="va">x</span>, <span class="va">xmax</span>, <span class="va">col</span>, <span class="va">shape</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Helper to make pooled + predicted rows (in that order)</span></span>
<span><span class="va">make_summary_rows</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">summ</span>, <span class="va">pi</span>, <span class="va">label_group</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pooled</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    lab   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">label_group</span>, <span class="st">" Pooled"</span><span class="op">)</span>,</span>
<span>    type  <span class="op">=</span> <span class="st">"pooled"</span>,</span>
<span>    xmin  <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_low</span>, x <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_median</span>, xmax <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_high</span>,</span>
<span>    col   <span class="op">=</span> <span class="st">"darkred"</span>, shape <span class="op">=</span> <span class="fl">15</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">predicted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    lab   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">label_group</span>, <span class="st">" Predicted"</span><span class="op">)</span>,</span>
<span>    type  <span class="op">=</span> <span class="st">"predicted"</span>,</span>
<span>    xmin  <span class="op">=</span> <span class="va">pi</span><span class="op">$</span><span class="va">pred_low</span>, x <span class="op">=</span> <span class="va">summ</span><span class="op">$</span><span class="va">mu_median</span>, xmax <span class="op">=</span> <span class="va">pi</span><span class="op">$</span><span class="va">pred_high</span>,</span>
<span>    col   <span class="op">=</span> <span class="st">"orange"</span>, shape <span class="op">=</span> <span class="fl">17</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span><span class="va">pooled</span>, <span class="va">predicted</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">rows_top_to_bottom</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html">bind_rows</a></span><span class="op">(</span></span>
<span>  <span class="co"># Subgroup 1500–3000 block</span></span>
<span>  <span class="fu">make_study_rows</span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"1500-3000"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span><span class="op">)</span>, <span class="st">"1500-3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu">make_summary_rows</span><span class="op">(</span><span class="va">summ_1</span>, <span class="va">pi_1</span>, <span class="st">"1500-3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"gap"</span>, xmin <span class="op">=</span> <span class="cn">NA</span>, x <span class="op">=</span> <span class="cn">NA</span>, xmax <span class="op">=</span> <span class="cn">NA</span>, col <span class="op">=</span> <span class="cn">NA</span>, shape <span class="op">=</span> <span class="cn">NA_real_</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Subgroup &gt;3000 block</span></span>
<span>  <span class="fu">make_study_rows</span><span class="op">(</span><span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="st">"&gt;3000"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span><span class="op">)</span>, <span class="st">"&gt;3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu">make_summary_rows</span><span class="op">(</span><span class="va">summ_2</span>, <span class="va">pi_2</span>, <span class="st">"&gt;3000"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>lab <span class="op">=</span> <span class="st">""</span>, type <span class="op">=</span> <span class="st">"gap"</span>, xmin <span class="op">=</span> <span class="cn">NA</span>, x <span class="op">=</span> <span class="cn">NA</span>, xmax <span class="op">=</span> <span class="cn">NA</span>, col <span class="op">=</span> <span class="cn">NA</span>, shape <span class="op">=</span> <span class="cn">NA_real_</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Overall at very bottom: pooled then predicted</span></span>
<span>  <span class="fu">make_summary_rows</span><span class="op">(</span><span class="va">summ_all</span>, <span class="va">pi_all</span>, <span class="st">"Overall"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">rows_top_to_bottom</span> <span class="op">&lt;-</span> <span class="va">rows_top_to_bottom</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>row_id <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html">row_number</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">row_id</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbarh</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"study"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"#1f77b4"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"study"</span><span class="op">)</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"#1f77b4"</span>, size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbarh</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"pooled"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"pooled"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shape</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"darkred"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html">geom_errorbarh</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"predicted"</span><span class="op">)</span>,</span>
<span>                 <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xmin</span>, xmax <span class="op">=</span> <span class="va">xmax</span><span class="op">)</span>, height <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>                 color <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"predicted"</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">shape</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"orange"</span>, size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"pooled"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xmax</span> <span class="op">+</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="st">"Pooled"</span><span class="op">)</span>,</span>
<span>            hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">3.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rows_top_to_bottom</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"predicted"</span><span class="op">)</span>,</span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xmax</span> <span class="op">+</span> <span class="fl">3</span>, y <span class="op">=</span> <span class="va">y</span>, label <span class="op">=</span> <span class="st">"Predicted"</span><span class="op">)</span>,</span>
<span>            hjust <span class="op">=</span> <span class="fl">0</span>, size <span class="op">=</span> <span class="fl">3.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="va">rows_top_to_bottom</span><span class="op">$</span><span class="va">y</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">rows_top_to_bottom</span><span class="op">$</span><span class="va">lab</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_shape_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>`15` <span class="op">=</span> <span class="fl">15</span>, `17` <span class="op">=</span> <span class="fl">17</span><span class="op">)</span>, guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Mean difference"</span>, y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Forest plot: CACs cores in male &amp; female athletes engaging in different volumes of exercise"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Points and horizontal lines represent posterior medians and 95% credible intervals"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>    plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">13</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Save plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"images/combined_forest_plot.png"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7.5</span>, height <span class="op">=</span> <span class="fl">8.5</span>, dpi <span class="op">=</span> <span class="fl">300</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"images/combined_forest_plot.pdf"</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7.5</span>, height <span class="op">=</span> <span class="fl">8.5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><img src="images/combined_forest_plot.png" class="img-fluid"> The plot shows mean difference = 3.6 (95% CI -10.3 to 16.5), with no evidence of a statistically significant difference.</p>
</section><section id="conclusion" class="level2"><h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>The original objective of the meta-analysis was to compare CAC scores in athletes versus nonathletes and while not reported in the final publication, this showed no meaningful differences. The authors reported only post hoc analyses according to sex and claim that “males with high-volume exercise training (&gt;3,000 MET-min/wk) exhibited a higher burden of calcified plaque by CAC score than male nonathletes”. This is somewhat disengenous as there was no difference between lower level exercise training (1,500 - 3,000 MET-min/wk) and calcified plaque by CAC score compared to male nonathletes, nor was there any statistically significant difference when comparing the high amd low groups.</p>
<p>It is well known that positive results have a higher probability of being published and a cynical reader might wonder if the authors, aware of this, were simply looking for anything positive, or at least trending to positive, to report and found it by examining subgroups according to sex and level of exercise training. This is known as p-hacking, although the proper analysis did not find a statistically significant p value, and is a well recognized source of bias in the scientific literature.</p>
<p>Deviations from the preregistered protocol, ignoring prior evidence of exercise benefits, and questionable statistical analyses weaken any possible useful inferences from this study. What then is the legacy of the publication beyond adding to the authors’ CVs?</p>
</section><section id="references" class="level2">


<!-- -->


</section><div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-RN2" class="csl-entry" role="listitem">
Abdelaziz, A., A. Elshahat, A. F. Gadelmawla, M. Desouky, A. H. Hafez, M. Abdelaziz, N. Hammad, et al. 2025. <span>“Sex Differences in the Impact of Exercise Volume on Subclinical Coronary Atherosclerosis: A Meta-Analysis.”</span> Journal Article. <em>JACC Adv</em> 4 (6 Pt 1): 101786. <a href="https://doi.org/10.1016/j.jacadv.2025.101786">https://doi.org/10.1016/j.jacadv.2025.101786</a>.
</div>
<div id="ref-RN5623" class="csl-entry" role="listitem">
Altman, D. G., and J. M. Bland. 2003. <span>“Interaction Revisited: The Difference Between Two Estimates.”</span> Journal Article. <em>BMJ</em> 326 (7382): 219. <a href="https://doi.org/10.1136/bmj.326.7382.219">https://doi.org/10.1136/bmj.326.7382.219</a>.
</div>
<div id="ref-RN7649" class="csl-entry" role="listitem">
Gelman, Andrew, and Hal and Stern. 2006. <span>“The Difference Between <span>‘Significant’</span> and <span>‘Not Significant’</span> Is Not Itself Statistically Significant.”</span> Journal Article. <em>The American Statistician</em> 60 (4): 328–31. <a href="https://doi.org/10.1198/000313006X152649">https://doi.org/10.1198/000313006X152649</a>.
</div>
</div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{brophy2025,
  author = {Brophy, Jay},
  title = {What Is the Goal of This Meta-Analysis?},
  date = {2025-11-27},
  url = {https://brophyj.com/posts/2025-06-29-my-blog-post/},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-brophy2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Brophy, Jay. 2025. <span>“What Is the Goal of This
Meta-Analysis?”</span> November 27, 2025. <a href="https://brophyj.com/posts/2025-06-29-my-blog-post/">https://brophyj.com/posts/2025-06-29-my-blog-post/</a>.
</div></div></section></div></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/brophyj\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "What is the goal of this meta-analysis?"</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Can always find something positive if you look hard enough"</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">  - name: Jay Brophy</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">    url: https://brophyj.github.io/</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="co">    orcid: 0000-0001-8049-6875</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation: McGill University Dept Medince, Epidemiology &amp; Biostatistics</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">    affiliation-url: https://mcgill.ca </span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="an">tags:</span><span class="co"> []</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [meta-analysis, bias]</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="an">image:</span><span class="co"> preview-image.jpg</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="an">citation:</span><span class="co"> </span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="co">  url: https://brophyj.com/posts/2025-06-29-my-blog-post/ </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> 2025-11-27T14:39:55-05:00</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="an">lastmod:</span><span class="co"> 2025-11-27T14:39:55-05:00</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="an">featured:</span><span class="co"> true</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Focal points: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight.</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="an">projects:</span><span class="co"> []</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true   # optional: adds copy/download buttons</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: sentence</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="an">bibliography:</span><span class="co"> [bib.bib]</span></span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a><span class="an">biblio-style:</span><span class="co"> apalike</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Recent article - Background</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>A recent meta-analysis<span class="co">[</span><span class="ot">@RN2</span><span class="co">]</span> concluded “Males with high-volume exercise training (&gt;3,000 MET-min/wk) exhibited a higher burden of calcified plaque by CAC score than male nonathletes, while no such difference was observed in female athletes.” Apart from the surprising observation of a positive association of increased exercise and increased cardiovascular risk factors, one is left wondering what was the original objective of this study. Perhaps a look at the pre-registered protocol (https://www.crd.york.ac.uk/PROSPERO/view/CRD42024573617) can help. Here the main outcome is stated</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; The primary outcome of interest was analysis of coronary artery calcium (CAC) score (between athletes and non-athletes). </span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>There is no mention of preplanned analyses according to sex of either the primary or any secondary outcome. Of course, results from post hoc analyses carry less inferential validity.      </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>Even ignoring the apparent post hoc nature of the analysis, how should these results be interpreted? How can they be sensibly interpreted without an idea of the prior probability that women would behave differently than men or that heavy exercising men would behave worse than moderately exercising men?    </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>Even ignoring the lack of prior probabilities, does the data show as contended by the authors that  male athletes engaging in high-volume exercise compared to nonathletes have higher CAC scores than athletes with moderate volume exercise compared to nonathletes. The CAC values for male athletes compared to nonathletes was 1.2 (95% CI -24.66 to 27.05, p = 0.9) for &lt; 3000 group and 31.62 (95% 10.66 to 52.58, p = 0.003) for group &gt; 3000. Are these differences statistically significant? </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>The fallacy of simply comparing significance levels has been well described  in several publications <span class="co">[</span><span class="ot">@RN7649; @RN5623</span><span class="co">]</span>. Testing for the statistical significance of the difference between two independent estimates is required to determine if they are statistically different and is easily implemented by calculating the risk difference and its confidence interval and p-value, as shown in the following code.</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction test for risk ratio RR</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>inter_test <span class="ot">&lt;-</span> <span class="cf">function</span>(rr1, rr1LL, rr1UL, rr2, rr2LL, rr2UL, <span class="at">sig=</span><span class="fl">0.975</span>) {</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>  logSE1 <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">log</span>(rr1UL) <span class="sc">-</span> <span class="fu">log</span>(rr1LL))<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">qnorm</span>(sig)) <span class="co">#se of log(rr1), default 95%CI, sig = 1 sided value</span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>  logSE2 <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">log</span>(rr2UL) <span class="sc">-</span> <span class="fu">log</span>(rr2LL))<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">qnorm</span>(sig)) <span class="co">#se of log(rr1)</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>  diffLogRR <span class="ot">&lt;-</span> <span class="fu">log</span>(rr1) <span class="sc">-</span> <span class="fu">log</span>(rr2) <span class="co">#diff of log rr</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>  logRR_SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(logSE1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> logSE2<span class="sc">^</span><span class="dv">2</span>) <span class="co">#log (se) of differences</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>  logRR_UCI <span class="ot">&lt;-</span> diffLogRR <span class="sc">+</span> <span class="fu">qnorm</span>(sig) <span class="sc">*</span> logRR_SE</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>  logRR_LCI <span class="ot">&lt;-</span> diffLogRR <span class="sc">-</span> <span class="fu">qnorm</span>(sig) <span class="sc">*</span> logRR_SE</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  RR <span class="ot">&lt;-</span> <span class="fu">exp</span>(diffLogRR) <span class="co"># RR point estimate</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  RR_UCI <span class="ot">&lt;-</span> <span class="fu">exp</span>(logRR_UCI) <span class="co"># RR upper CI</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>  RR_LCI <span class="ot">&lt;-</span> <span class="fu">exp</span>(logRR_LCI) <span class="co"># RR lower CI</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>  RR_SE <span class="ot">&lt;-</span> (RR_UCI <span class="sc">-</span> RR_LCI) <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span><span class="fl">1.96</span>)</span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> diffLogRR <span class="sc">/</span> logRR_SE</span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  pvalue <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(z))) <span class="co">#p value for the interaction term</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  state1 <span class="ot">&lt;-</span> <span class="fu">cat</span>(<span class="st">"The relative risk for the interaction is "</span>, RR, <span class="st">", 95% CI "</span>, RR_LCI, <span class="st">" - "</span>, RR_UCI, <span class="st">" and p value ="</span> , pvalue)</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Interaction test for risk difference #</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a><span class="do">###############</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>inter_test_rd <span class="ot">&lt;-</span> <span class="cf">function</span>(rd1, rd1LL, rd1UL, rd2, rd2LL, rd2UL, <span class="at">sig=</span><span class="fl">0.975</span>) {</span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>  se1 <span class="ot">&lt;-</span> <span class="fu">abs</span>(rd1UL <span class="sc">-</span> rd1LL)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">qnorm</span>(sig)) <span class="co">#se of risk difference 1</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>  se2 <span class="ot">&lt;-</span> <span class="fu">abs</span>(rd2UL <span class="sc">-</span> rd2LL)<span class="sc">/</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">qnorm</span>(sig)) <span class="co">#se of risk difference 2</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>  diffRD <span class="ot">&lt;-</span> rd1 <span class="sc">-</span> rd2 <span class="co">#diff of risk difference</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>  RD_SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(se1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> se2<span class="sc">^</span><span class="dv">2</span>) <span class="co">#se of differences</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>  RD_UCI <span class="ot">&lt;-</span> diffRD <span class="sc">+</span> <span class="fu">qnorm</span>(sig) <span class="sc">*</span> RD_SE</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  RD_LCI <span class="ot">&lt;-</span> diffRD <span class="sc">-</span> <span class="fu">qnorm</span>(sig) <span class="sc">*</span> RD_SE</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>  pvalue <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(diffRD<span class="sc">/</span>RD_SE))) <span class="co">#p value for the interaction term</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># cat("The risk difference for the interaction is ", diffRD, ", 95% CI ", RD_LCI, " - ", RD_UCI, " and p value =" , pvalue)</span></span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">diffRD =</span> diffRD, <span class="at">RD_LCI =</span> RD_LCI, <span class="at">RD_UCI =</span> RD_UCI, <span class="at">pvalue =</span> pvalue)</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>rd_out <span class="ot">&lt;-</span> <span class="fu">inter_test_rd</span>(<span class="fl">1.2</span>, <span class="sc">-</span><span class="fl">24.66</span>, <span class="fl">27.05</span>, <span class="fl">31.62</span>, <span class="fl">10.66</span>, <span class="fl">52.58</span>)</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>The risk difference for the interaction is  <span class="in">`r rd_out$diffRD`</span>, (95% CI  <span class="in">`r round(rd_out$RD_LCI,2)`</span> to <span class="in">`r round(rd_out$RD_UCI,2)`</span>,  p = <span class="in">`r round(rd_out$pvalue,2)`</span>). The key insight being “In making a comparison between two group, one should look at the statistical significance of the difference rather than the difference between their significance levels”<span class="co">[</span><span class="ot">@RN7649</span><span class="co">]</span>. Thus, there is no statistical evidence of a difference in CAC values between male athletes engaging in high-volume exercise compared to nonathletes and male athletes with moderate volume exercise compared to nonathletes. This becomes more evident if the forest plots (Bayesian with vague priors) are recreated with the prediction intervals showing the considerable overalp in the predcited next study for the subgroups.</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a><span class="co"># men</span></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Packages ----</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Data (extracted from your figure) ----</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>group,        <span class="sc">~</span>study,               <span class="sc">~</span>yi,   <span class="sc">~</span>lower,   <span class="sc">~</span>upper,</span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1500-3000"</span>,   <span class="st">"Aengevaeren 2017"</span>,   <span class="fl">11.50</span>,   <span class="fl">2.92</span>,   <span class="fl">20.08</span>,</span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1500-3000"</span>,   <span class="st">"Pavlovic 2024"</span>,      <span class="fl">16.50</span>,  <span class="sc">-</span><span class="fl">0.16</span>,   <span class="fl">33.16</span>,</span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1500-3000"</span>,   <span class="st">"Defina 2019"</span>,       <span class="sc">-</span><span class="fl">27.12</span>, <span class="sc">-</span><span class="fl">47.05</span>,   <span class="sc">-</span><span class="fl">6.99</span>,</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;3000"</span>,       <span class="st">"Bosscher 2023"</span>,      <span class="fl">19.80</span>,   <span class="fl">8.84</span>,   <span class="fl">30.76</span>,</span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;3000"</span>,       <span class="st">"Mohlenkamp 2008"</span>,     <span class="fl">9.08</span>, <span class="sc">-</span><span class="fl">18.88</span>,   <span class="fl">37.04</span>,</span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;3000"</span>,       <span class="st">"Pavlovic 2024"</span>,      <span class="fl">25.06</span>,  <span class="fl">13.55</span>,   <span class="fl">37.57</span>,</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;3000"</span>,       <span class="st">"Defina 2019"</span>,        <span class="fl">42.50</span>,  <span class="fl">12.08</span>,   <span class="fl">72.92</span></span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">sei =</span> (upper <span class="sc">-</span> lower) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">study =</span> <span class="fu">factor</span>(study),</span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1500-3000"</span>, <span class="st">"&gt;3000"</span>)) <span class="co"># explicit subgroup order</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-117"><a href="#cb4-117" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Priors: vague but weakly informative ----</span></span>
<span id="cb4-118"><a href="#cb4-118" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-119"><a href="#cb4-119" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),              <span class="co"># mu ~ N(0, 50^2)</span></span>
<span id="cb4-120"><a href="#cb4-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>)<span class="co"># tau ~ t(3,0,10)</span></span>
<span id="cb4-121"><a href="#cb4-121" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-122"><a href="#cb4-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-123"><a href="#cb4-123" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Fit models ----</span></span>
<span id="cb4-124"><a href="#cb4-124" aria-hidden="true" tabindex="-1"></a>fit_all <span class="ot">&lt;-</span> <span class="fu">brm</span>(yi <span class="sc">|</span> <span class="fu">se</span>(sei) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study),</span>
<span id="cb4-125"><a href="#cb4-125" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb4-126"><a href="#cb4-126" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> priors, <span class="at">backend =</span> <span class="st">"cmdstanr"</span>,</span>
<span id="cb4-127"><a href="#cb4-127" aria-hidden="true" tabindex="-1"></a>               <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb4-128"><a href="#cb4-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-129"><a href="#cb4-129" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model object to disk</span></span>
<span id="cb4-130"><a href="#cb4-130" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit_all, <span class="at">file =</span> <span class="st">"model/fit_all.rds"</span>)</span>
<span id="cb4-131"><a href="#cb4-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-132"><a href="#cb4-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-133"><a href="#cb4-133" aria-hidden="true" tabindex="-1"></a>fit_1500 <span class="ot">&lt;-</span> <span class="fu">brm</span>(yi <span class="sc">|</span> <span class="fu">se</span>(sei) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study),</span>
<span id="cb4-134"><a href="#cb4-134" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(df, group <span class="sc">==</span> <span class="st">"1500-3000"</span>),</span>
<span id="cb4-135"><a href="#cb4-135" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">prior =</span> priors,</span>
<span id="cb4-136"><a href="#cb4-136" aria-hidden="true" tabindex="-1"></a>                <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb4-137"><a href="#cb4-137" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit_all, <span class="at">file =</span> <span class="st">"model/fit_1500.rds"</span>)</span>
<span id="cb4-138"><a href="#cb4-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-139"><a href="#cb4-139" aria-hidden="true" tabindex="-1"></a>fit_3000 <span class="ot">&lt;-</span> <span class="fu">brm</span>(yi <span class="sc">|</span> <span class="fu">se</span>(sei) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study),</span>
<span id="cb4-140"><a href="#cb4-140" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(df, group <span class="sc">==</span> <span class="st">"&gt;3000"</span>),</span>
<span id="cb4-141"><a href="#cb4-141" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">prior =</span> priors,</span>
<span id="cb4-142"><a href="#cb4-142" aria-hidden="true" tabindex="-1"></a>                <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb4-143"><a href="#cb4-143" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit_all, <span class="at">file =</span> <span class="st">"model/fit_3000.rds"</span>)</span>
<span id="cb4-144"><a href="#cb4-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-145"><a href="#cb4-145" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Posterior draws ----</span></span>
<span id="cb4-146"><a href="#cb4-146" aria-hidden="true" tabindex="-1"></a>draws_all <span class="ot">&lt;-</span> fit_all <span class="sc">%&gt;%</span> <span class="fu">spread_draws</span>(b_Intercept, sd_study__Intercept)</span>
<span id="cb4-147"><a href="#cb4-147" aria-hidden="true" tabindex="-1"></a>draws_1   <span class="ot">&lt;-</span> fit_1500 <span class="sc">%&gt;%</span> <span class="fu">spread_draws</span>(b_Intercept, sd_study__Intercept)</span>
<span id="cb4-148"><a href="#cb4-148" aria-hidden="true" tabindex="-1"></a>draws_2   <span class="ot">&lt;-</span> fit_3000 <span class="sc">%&gt;%</span> <span class="fu">spread_draws</span>(b_Intercept, sd_study__Intercept)</span>
<span id="cb4-149"><a href="#cb4-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-150"><a href="#cb4-150" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Summaries (μ and τ) ----</span></span>
<span id="cb4-151"><a href="#cb4-151" aria-hidden="true" tabindex="-1"></a>summarise_mu_tau <span class="ot">&lt;-</span> <span class="cf">function</span>(dr) {</span>
<span id="cb4-152"><a href="#cb4-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb4-153"><a href="#cb4-153" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu_median  =</span> <span class="fu">median</span>(dr<span class="sc">$</span>b_Intercept),</span>
<span id="cb4-154"><a href="#cb4-154" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu_low     =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>b_Intercept, <span class="fl">0.025</span>),</span>
<span id="cb4-155"><a href="#cb4-155" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu_high    =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>b_Intercept, <span class="fl">0.975</span>),</span>
<span id="cb4-156"><a href="#cb4-156" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau_median =</span> <span class="fu">median</span>(dr<span class="sc">$</span>sd_study__Intercept),</span>
<span id="cb4-157"><a href="#cb4-157" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau_low    =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>sd_study__Intercept, <span class="fl">0.025</span>),</span>
<span id="cb4-158"><a href="#cb4-158" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau_high   =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>sd_study__Intercept, <span class="fl">0.975</span>)</span>
<span id="cb4-159"><a href="#cb4-159" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-160"><a href="#cb4-160" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-161"><a href="#cb4-161" aria-hidden="true" tabindex="-1"></a>summ_all <span class="ot">&lt;-</span> <span class="fu">summarise_mu_tau</span>(draws_all)</span>
<span id="cb4-162"><a href="#cb4-162" aria-hidden="true" tabindex="-1"></a>summ_1   <span class="ot">&lt;-</span> <span class="fu">summarise_mu_tau</span>(draws_1)</span>
<span id="cb4-163"><a href="#cb4-163" aria-hidden="true" tabindex="-1"></a>summ_2   <span class="ot">&lt;-</span> <span class="fu">summarise_mu_tau</span>(draws_2)</span>
<span id="cb4-164"><a href="#cb4-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-165"><a href="#cb4-165" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Prediction intervals (new TRUE study effect) ----</span></span>
<span id="cb4-166"><a href="#cb4-166" aria-hidden="true" tabindex="-1"></a>summarise_pred <span class="ot">&lt;-</span> <span class="cf">function</span>(dr) {</span>
<span id="cb4-167"><a href="#cb4-167" aria-hidden="true" tabindex="-1"></a>  theta_new <span class="ot">&lt;-</span> dr<span class="sc">$</span>b_Intercept <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(dr)) <span class="sc">*</span> dr<span class="sc">$</span>sd_study__Intercept</span>
<span id="cb4-168"><a href="#cb4-168" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb4-169"><a href="#cb4-169" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_low  =</span> <span class="fu">quantile</span>(theta_new, <span class="fl">0.025</span>),</span>
<span id="cb4-170"><a href="#cb4-170" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_high =</span> <span class="fu">quantile</span>(theta_new, <span class="fl">0.975</span>)</span>
<span id="cb4-171"><a href="#cb4-171" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-172"><a href="#cb4-172" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-173"><a href="#cb4-173" aria-hidden="true" tabindex="-1"></a>pi_all <span class="ot">&lt;-</span> <span class="fu">summarise_pred</span>(draws_all)</span>
<span id="cb4-174"><a href="#cb4-174" aria-hidden="true" tabindex="-1"></a>pi_1   <span class="ot">&lt;-</span> <span class="fu">summarise_pred</span>(draws_1)</span>
<span id="cb4-175"><a href="#cb4-175" aria-hidden="true" tabindex="-1"></a>pi_2   <span class="ot">&lt;-</span> <span class="fu">summarise_pred</span>(draws_2)</span>
<span id="cb4-176"><a href="#cb4-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-177"><a href="#cb4-177" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Build plotting rows with exact order ----</span></span>
<span id="cb4-178"><a href="#cb4-178" aria-hidden="true" tabindex="-1"></a><span class="co"># Desired order from TOP to BOTTOM:</span></span>
<span id="cb4-179"><a href="#cb4-179" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Subgroup "1500-3000": its studies (top), then "1500-3000 Pooled", then "1500-3000 Predicted"</span></span>
<span id="cb4-180"><a href="#cb4-180" aria-hidden="true" tabindex="-1"></a><span class="co">#    then a GAP</span></span>
<span id="cb4-181"><a href="#cb4-181" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Subgroup "&gt;3000":     its studies, then "&gt;3000 Pooled", then "&gt;3000 Predicted"</span></span>
<span id="cb4-182"><a href="#cb4-182" aria-hidden="true" tabindex="-1"></a><span class="co">#    then a GAP</span></span>
<span id="cb4-183"><a href="#cb4-183" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Overall:              "Overall Pooled", then "Overall Predicted" (very bottom)</span></span>
<span id="cb4-184"><a href="#cb4-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-185"><a href="#cb4-185" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper to make study rows</span></span>
<span id="cb4-186"><a href="#cb4-186" aria-hidden="true" tabindex="-1"></a>make_study_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(dsub, label_group) {</span>
<span id="cb4-187"><a href="#cb4-187" aria-hidden="true" tabindex="-1"></a>  dsub <span class="sc">%&gt;%</span></span>
<span id="cb4-188"><a href="#cb4-188" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb4-189"><a href="#cb4-189" aria-hidden="true" tabindex="-1"></a>      <span class="at">lab   =</span> <span class="fu">paste0</span>(study, <span class="st">" ("</span>, label_group, <span class="st">")"</span>),</span>
<span id="cb4-190"><a href="#cb4-190" aria-hidden="true" tabindex="-1"></a>      <span class="at">type  =</span> <span class="st">"study"</span>,</span>
<span id="cb4-191"><a href="#cb4-191" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin  =</span> lower, <span class="at">x =</span> yi, <span class="at">xmax =</span> upper,</span>
<span id="cb4-192"><a href="#cb4-192" aria-hidden="true" tabindex="-1"></a>      <span class="at">col   =</span> <span class="st">"#1f77b4"</span>, <span class="at">shape =</span> <span class="cn">NA_real_</span></span>
<span id="cb4-193"><a href="#cb4-193" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-194"><a href="#cb4-194" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(lab, type, xmin, x, xmax, col, shape)</span>
<span id="cb4-195"><a href="#cb4-195" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-196"><a href="#cb4-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-197"><a href="#cb4-197" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper to make pooled + predicted rows (in that order)</span></span>
<span id="cb4-198"><a href="#cb4-198" aria-hidden="true" tabindex="-1"></a>make_summary_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(summ, pi, label_group) {</span>
<span id="cb4-199"><a href="#cb4-199" aria-hidden="true" tabindex="-1"></a>  pooled <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-200"><a href="#cb4-200" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab   =</span> <span class="fu">paste0</span>(label_group, <span class="st">" Pooled"</span>),</span>
<span id="cb4-201"><a href="#cb4-201" aria-hidden="true" tabindex="-1"></a>    <span class="at">type  =</span> <span class="st">"pooled"</span>,</span>
<span id="cb4-202"><a href="#cb4-202" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin  =</span> summ<span class="sc">$</span>mu_low, <span class="at">x =</span> summ<span class="sc">$</span>mu_median, <span class="at">xmax =</span> summ<span class="sc">$</span>mu_high,</span>
<span id="cb4-203"><a href="#cb4-203" aria-hidden="true" tabindex="-1"></a>    <span class="at">col   =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">15</span></span>
<span id="cb4-204"><a href="#cb4-204" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-205"><a href="#cb4-205" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-206"><a href="#cb4-206" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab   =</span> <span class="fu">paste0</span>(label_group, <span class="st">" Predicted"</span>),</span>
<span id="cb4-207"><a href="#cb4-207" aria-hidden="true" tabindex="-1"></a>    <span class="at">type  =</span> <span class="st">"predicted"</span>,</span>
<span id="cb4-208"><a href="#cb4-208" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin  =</span> pi<span class="sc">$</span>pred_low, <span class="at">x =</span> summ<span class="sc">$</span>mu_median, <span class="at">xmax =</span> pi<span class="sc">$</span>pred_high,</span>
<span id="cb4-209"><a href="#cb4-209" aria-hidden="true" tabindex="-1"></a>    <span class="at">col   =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">17</span></span>
<span id="cb4-210"><a href="#cb4-210" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-211"><a href="#cb4-211" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(pooled, predicted)</span>
<span id="cb4-212"><a href="#cb4-212" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-213"><a href="#cb4-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-214"><a href="#cb4-214" aria-hidden="true" tabindex="-1"></a>rows_top_to_bottom <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb4-215"><a href="#cb4-215" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subgroup 1500–3000 block</span></span>
<span id="cb4-216"><a href="#cb4-216" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_study_rows</span>(df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"1500-3000"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(study)), <span class="st">"1500-3000"</span>),</span>
<span id="cb4-217"><a href="#cb4-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_summary_rows</span>(summ_1, pi_1, <span class="st">"1500-3000"</span>),</span>
<span id="cb4-218"><a href="#cb4-218" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">lab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"gap"</span>, <span class="at">xmin =</span> <span class="cn">NA</span>, <span class="at">x =</span> <span class="cn">NA</span>, <span class="at">xmax =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">shape =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb4-219"><a href="#cb4-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-220"><a href="#cb4-220" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subgroup &gt;3000 block</span></span>
<span id="cb4-221"><a href="#cb4-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_study_rows</span>(df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"&gt;3000"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(study)), <span class="st">"&gt;3000"</span>),</span>
<span id="cb4-222"><a href="#cb4-222" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_summary_rows</span>(summ_2, pi_2, <span class="st">"&gt;3000"</span>),</span>
<span id="cb4-223"><a href="#cb4-223" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">lab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"gap"</span>, <span class="at">xmin =</span> <span class="cn">NA</span>, <span class="at">x =</span> <span class="cn">NA</span>, <span class="at">xmax =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">shape =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb4-224"><a href="#cb4-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-225"><a href="#cb4-225" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Overall at very bottom: pooled then predicted</span></span>
<span id="cb4-226"><a href="#cb4-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_summary_rows</span>(summ_all, pi_all, <span class="st">"Overall"</span>)</span>
<span id="cb4-227"><a href="#cb4-227" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-228"><a href="#cb4-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-229"><a href="#cb4-229" aria-hidden="true" tabindex="-1"></a>rows_top_to_bottom <span class="ot">&lt;-</span> rows_top_to_bottom <span class="sc">%&gt;%</span></span>
<span id="cb4-230"><a href="#cb4-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row_id =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-231"><a href="#cb4-231" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rev</span>(row_id))</span>
<span id="cb4-232"><a href="#cb4-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-233"><a href="#cb4-233" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-234"><a href="#cb4-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-235"><a href="#cb4-235" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rows_top_to_bottom, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb4-236"><a href="#cb4-236" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"study"</span>),</span>
<span id="cb4-237"><a href="#cb4-237" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), <span class="at">height =</span> <span class="fl">0.2</span>,</span>
<span id="cb4-238"><a href="#cb4-238" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"#1f77b4"</span>) <span class="sc">+</span></span>
<span id="cb4-239"><a href="#cb4-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"study"</span>),</span>
<span id="cb4-240"><a href="#cb4-240" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#1f77b4"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-241"><a href="#cb4-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"pooled"</span>),</span>
<span id="cb4-242"><a href="#cb4-242" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), <span class="at">height =</span> <span class="fl">0.3</span>,</span>
<span id="cb4-243"><a href="#cb4-243" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb4-244"><a href="#cb4-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"pooled"</span>),</span>
<span id="cb4-245"><a href="#cb4-245" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">shape =</span> <span class="fu">factor</span>(shape)), <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb4-246"><a href="#cb4-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"predicted"</span>),</span>
<span id="cb4-247"><a href="#cb4-247" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), <span class="at">height =</span> <span class="fl">0.3</span>,</span>
<span id="cb4-248"><a href="#cb4-248" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb4-249"><a href="#cb4-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"predicted"</span>),</span>
<span id="cb4-250"><a href="#cb4-250" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">shape =</span> <span class="fu">factor</span>(shape)), <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb4-251"><a href="#cb4-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb4-252"><a href="#cb4-252" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"pooled"</span>),</span>
<span id="cb4-253"><a href="#cb4-253" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> xmax <span class="sc">+</span> <span class="dv">3</span>, <span class="at">y =</span> y, <span class="at">label =</span> <span class="st">"Pooled"</span>),</span>
<span id="cb4-254"><a href="#cb4-254" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb4-255"><a href="#cb4-255" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"predicted"</span>),</span>
<span id="cb4-256"><a href="#cb4-256" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> xmax <span class="sc">+</span> <span class="dv">3</span>, <span class="at">y =</span> y, <span class="at">label =</span> <span class="st">"Predicted"</span>),</span>
<span id="cb4-257"><a href="#cb4-257" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb4-258"><a href="#cb4-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb4-259"><a href="#cb4-259" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> rows_top_to_bottom<span class="sc">$</span>y,</span>
<span id="cb4-260"><a href="#cb4-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> rows_top_to_bottom<span class="sc">$</span>lab</span>
<span id="cb4-261"><a href="#cb4-261" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-262"><a href="#cb4-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">15</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">15</span>, <span class="st">`</span><span class="at">17</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">17</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb4-263"><a href="#cb4-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-264"><a href="#cb4-264" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mean difference"</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-265"><a href="#cb4-265" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Forest plot: CACs cores in male athletes engaging in different volumes of exercise"</span>,</span>
<span id="cb4-266"><a href="#cb4-266" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Points and horizontal lines represent posterior medians and 95% credible intervals"</span>) <span class="sc">+</span></span>
<span id="cb4-267"><a href="#cb4-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-268"><a href="#cb4-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-269"><a href="#cb4-269" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb4-270"><a href="#cb4-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb4-271"><a href="#cb4-271" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-272"><a href="#cb4-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-273"><a href="#cb4-273" aria-hidden="true" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb4-274"><a href="#cb4-274" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/male_forest_plot.png"</span>, p, <span class="at">width =</span> <span class="fl">7.5</span>, <span class="at">height =</span> <span class="fl">8.5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb4-275"><a href="#cb4-275" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/male_forest_plot.pdf"</span>, p, <span class="at">width =</span> <span class="fl">7.5</span>, <span class="at">height =</span> <span class="fl">8.5</span>)</span>
<span id="cb4-276"><a href="#cb4-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-277"><a href="#cb4-277" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-278"><a href="#cb4-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-279"><a href="#cb4-279" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/male_forest_plot.png)</span></span>
<span id="cb4-280"><a href="#cb4-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-281"><a href="#cb4-281" aria-hidden="true" tabindex="-1"></a>What if the authors had followed their protocol and examined CAC scores in all athletes compared to nonathletes? </span>
<span id="cb4-282"><a href="#cb4-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r eval=FALSE}</span></span>
<span id="cb4-283"><a href="#cb4-283" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Packages ----</span></span>
<span id="cb4-284"><a href="#cb4-284" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb4-285"><a href="#cb4-285" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(brms)</span>
<span id="cb4-286"><a href="#cb4-286" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidybayes)</span>
<span id="cb4-287"><a href="#cb4-287" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb4-288"><a href="#cb4-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-289"><a href="#cb4-289" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">mc.cores =</span> parallel<span class="sc">::</span><span class="fu">detectCores</span>())</span>
<span id="cb4-290"><a href="#cb4-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-291"><a href="#cb4-291" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Data (extracted from your figure) ----</span></span>
<span id="cb4-292"><a href="#cb4-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-293"><a href="#cb4-293" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Data (COMBINED Male + Female) ----</span></span>
<span id="cb4-294"><a href="#cb4-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-295"><a href="#cb4-295" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Data (COMBINED Male + Female, grouped) ----</span></span>
<span id="cb4-296"><a href="#cb4-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-297"><a href="#cb4-297" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb4-298"><a href="#cb4-298" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>group,        <span class="sc">~</span>study,               <span class="sc">~</span>yi,    <span class="sc">~</span>lower,    <span class="sc">~</span>upper,</span>
<span id="cb4-299"><a href="#cb4-299" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1500-3000"</span>,   <span class="st">"Aengevaeren 2017"</span>,   <span class="sc">-</span><span class="fl">1.75</span>,  <span class="sc">-</span><span class="fl">13.54</span>,    <span class="fl">10.04</span>,</span>
<span id="cb4-300"><a href="#cb4-300" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1500-3000"</span>,   <span class="st">"Pavlovic 2024"</span>,      <span class="fl">13.25</span>,   <span class="sc">-</span><span class="fl">2.58</span>,    <span class="fl">29.08</span>,</span>
<span id="cb4-301"><a href="#cb4-301" aria-hidden="true" tabindex="-1"></a>  <span class="st">"1500-3000"</span>,   <span class="st">"Defina 2019"</span>,       <span class="sc">-</span><span class="fl">23.56</span>,  <span class="sc">-</span><span class="fl">43.53</span>,    <span class="sc">-</span><span class="fl">3.50</span>,</span>
<span id="cb4-302"><a href="#cb4-302" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;3000"</span>,       <span class="st">"Bosscher 2023"</span>,      <span class="fl">17.40</span>,    <span class="fl">4.42</span>,    <span class="fl">30.38</span>,</span>
<span id="cb4-303"><a href="#cb4-303" aria-hidden="true" tabindex="-1"></a>  <span class="st">"&gt;3000"</span>,       <span class="st">"Mohlenkamp 2008"</span>,     <span class="fl">7.04</span>,  <span class="sc">-</span><span class="fl">14.44</span>,    <span class="fl">28.52</span></span>
<span id="cb4-304"><a href="#cb4-304" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb4-305"><a href="#cb4-305" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-306"><a href="#cb4-306" aria-hidden="true" tabindex="-1"></a>    <span class="at">sei =</span> (upper <span class="sc">-</span> lower) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fl">1.96</span>),</span>
<span id="cb4-307"><a href="#cb4-307" aria-hidden="true" tabindex="-1"></a>    <span class="at">study =</span> <span class="fu">factor</span>(study),</span>
<span id="cb4-308"><a href="#cb4-308" aria-hidden="true" tabindex="-1"></a>    <span class="at">group =</span> <span class="fu">factor</span>(group, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"1500-3000"</span>, <span class="st">"&gt;3000"</span>))</span>
<span id="cb4-309"><a href="#cb4-309" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-310"><a href="#cb4-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-311"><a href="#cb4-311" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-312"><a href="#cb4-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-313"><a href="#cb4-313" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Priors: vague but weakly informative ----</span></span>
<span id="cb4-314"><a href="#cb4-314" aria-hidden="true" tabindex="-1"></a>priors <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb4-315"><a href="#cb4-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">50</span>), <span class="at">class =</span> <span class="st">"Intercept"</span>),              <span class="co"># mu ~ N(0, 50^2)</span></span>
<span id="cb4-316"><a href="#cb4-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">prior</span>(<span class="fu">student_t</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">10</span>), <span class="at">class =</span> <span class="st">"sd"</span>, <span class="at">group =</span> <span class="st">"study"</span>)<span class="co"># tau ~ t(3,0,10)</span></span>
<span id="cb4-317"><a href="#cb4-317" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-318"><a href="#cb4-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-319"><a href="#cb4-319" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Fit models ----</span></span>
<span id="cb4-320"><a href="#cb4-320" aria-hidden="true" tabindex="-1"></a>fit_all <span class="ot">&lt;-</span> <span class="fu">brm</span>(yi <span class="sc">|</span> <span class="fu">se</span>(sei) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study),</span>
<span id="cb4-321"><a href="#cb4-321" aria-hidden="true" tabindex="-1"></a>               <span class="at">data =</span> df, <span class="at">family =</span> <span class="fu">gaussian</span>(),</span>
<span id="cb4-322"><a href="#cb4-322" aria-hidden="true" tabindex="-1"></a>               <span class="at">prior =</span> priors, <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, </span>
<span id="cb4-323"><a href="#cb4-323" aria-hidden="true" tabindex="-1"></a>               <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">123</span>, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb4-324"><a href="#cb4-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-325"><a href="#cb4-325" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the model object to disk</span></span>
<span id="cb4-326"><a href="#cb4-326" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit_all, <span class="at">file =</span> <span class="st">"model/combined_all.rds"</span>)</span>
<span id="cb4-327"><a href="#cb4-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-328"><a href="#cb4-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-329"><a href="#cb4-329" aria-hidden="true" tabindex="-1"></a>fit_1500 <span class="ot">&lt;-</span> <span class="fu">brm</span>(yi <span class="sc">|</span> <span class="fu">se</span>(sei) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study),</span>
<span id="cb4-330"><a href="#cb4-330" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(df, group <span class="sc">==</span> <span class="st">"1500-3000"</span>),</span>
<span id="cb4-331"><a href="#cb4-331" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">prior =</span> priors,</span>
<span id="cb4-332"><a href="#cb4-332" aria-hidden="true" tabindex="-1"></a>                <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">seed =</span> <span class="dv">123</span>, <span class="at">refresh =</span> <span class="dv">0</span>)</span>
<span id="cb4-333"><a href="#cb4-333" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit_all, <span class="at">file =</span> <span class="st">"model/combined_1500.rds"</span>)</span>
<span id="cb4-334"><a href="#cb4-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-335"><a href="#cb4-335" aria-hidden="true" tabindex="-1"></a>fit_3000 <span class="ot">&lt;-</span> <span class="fu">brm</span>(yi <span class="sc">|</span> <span class="fu">se</span>(sei) <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> study),</span>
<span id="cb4-336"><a href="#cb4-336" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(df, group <span class="sc">==</span> <span class="st">"&gt;3000"</span>),</span>
<span id="cb4-337"><a href="#cb4-337" aria-hidden="true" tabindex="-1"></a>                <span class="at">family =</span> <span class="fu">gaussian</span>(), <span class="at">prior =</span> priors,</span>
<span id="cb4-338"><a href="#cb4-338" aria-hidden="true" tabindex="-1"></a>                <span class="at">backend =</span> <span class="st">"cmdstanr"</span>, <span class="at">iter =</span> <span class="dv">4000</span>, <span class="at">chains =</span> <span class="dv">4</span>, <span class="at">refresh =</span> <span class="dv">0</span>, <span class="at">seed =</span> <span class="dv">123</span>)</span>
<span id="cb4-339"><a href="#cb4-339" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(fit_all, <span class="at">file =</span> <span class="st">"model/combined_3000.rds"</span>)</span>
<span id="cb4-340"><a href="#cb4-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-341"><a href="#cb4-341" aria-hidden="true" tabindex="-1"></a>fit_all <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"model/combined_all.rds"</span>)</span>
<span id="cb4-342"><a href="#cb4-342" aria-hidden="true" tabindex="-1"></a>fit_1500 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"model/combined_1500.rds"</span>)</span>
<span id="cb4-343"><a href="#cb4-343" aria-hidden="true" tabindex="-1"></a>fit_3000 <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"model/combined_3000.rds"</span>)</span>
<span id="cb4-344"><a href="#cb4-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-345"><a href="#cb4-345" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Posterior draws ----</span></span>
<span id="cb4-346"><a href="#cb4-346" aria-hidden="true" tabindex="-1"></a>draws_all <span class="ot">&lt;-</span> fit_all <span class="sc">%&gt;%</span> <span class="fu">spread_draws</span>(b_Intercept, sd_study__Intercept)</span>
<span id="cb4-347"><a href="#cb4-347" aria-hidden="true" tabindex="-1"></a>draws_1   <span class="ot">&lt;-</span> fit_1500 <span class="sc">%&gt;%</span> <span class="fu">spread_draws</span>(b_Intercept, sd_study__Intercept)</span>
<span id="cb4-348"><a href="#cb4-348" aria-hidden="true" tabindex="-1"></a>draws_2   <span class="ot">&lt;-</span> fit_3000 <span class="sc">%&gt;%</span> <span class="fu">spread_draws</span>(b_Intercept, sd_study__Intercept)</span>
<span id="cb4-349"><a href="#cb4-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-350"><a href="#cb4-350" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Summaries (μ and τ) ----</span></span>
<span id="cb4-351"><a href="#cb4-351" aria-hidden="true" tabindex="-1"></a>summarise_mu_tau <span class="ot">&lt;-</span> <span class="cf">function</span>(dr) {</span>
<span id="cb4-352"><a href="#cb4-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb4-353"><a href="#cb4-353" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu_median  =</span> <span class="fu">median</span>(dr<span class="sc">$</span>b_Intercept),</span>
<span id="cb4-354"><a href="#cb4-354" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu_low     =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>b_Intercept, <span class="fl">0.025</span>),</span>
<span id="cb4-355"><a href="#cb4-355" aria-hidden="true" tabindex="-1"></a>    <span class="at">mu_high    =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>b_Intercept, <span class="fl">0.975</span>),</span>
<span id="cb4-356"><a href="#cb4-356" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau_median =</span> <span class="fu">median</span>(dr<span class="sc">$</span>sd_study__Intercept),</span>
<span id="cb4-357"><a href="#cb4-357" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau_low    =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>sd_study__Intercept, <span class="fl">0.025</span>),</span>
<span id="cb4-358"><a href="#cb4-358" aria-hidden="true" tabindex="-1"></a>    <span class="at">tau_high   =</span> <span class="fu">quantile</span>(dr<span class="sc">$</span>sd_study__Intercept, <span class="fl">0.975</span>)</span>
<span id="cb4-359"><a href="#cb4-359" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-360"><a href="#cb4-360" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-361"><a href="#cb4-361" aria-hidden="true" tabindex="-1"></a>summ_all <span class="ot">&lt;-</span> <span class="fu">summarise_mu_tau</span>(draws_all)</span>
<span id="cb4-362"><a href="#cb4-362" aria-hidden="true" tabindex="-1"></a>summ_1   <span class="ot">&lt;-</span> <span class="fu">summarise_mu_tau</span>(draws_1)</span>
<span id="cb4-363"><a href="#cb4-363" aria-hidden="true" tabindex="-1"></a>summ_2   <span class="ot">&lt;-</span> <span class="fu">summarise_mu_tau</span>(draws_2)</span>
<span id="cb4-364"><a href="#cb4-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-365"><a href="#cb4-365" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Prediction intervals (new TRUE study effect) ----</span></span>
<span id="cb4-366"><a href="#cb4-366" aria-hidden="true" tabindex="-1"></a>summarise_pred <span class="ot">&lt;-</span> <span class="cf">function</span>(dr) {</span>
<span id="cb4-367"><a href="#cb4-367" aria-hidden="true" tabindex="-1"></a>  theta_new <span class="ot">&lt;-</span> dr<span class="sc">$</span>b_Intercept <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="fu">nrow</span>(dr)) <span class="sc">*</span> dr<span class="sc">$</span>sd_study__Intercept</span>
<span id="cb4-368"><a href="#cb4-368" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(</span>
<span id="cb4-369"><a href="#cb4-369" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_low  =</span> <span class="fu">quantile</span>(theta_new, <span class="fl">0.025</span>),</span>
<span id="cb4-370"><a href="#cb4-370" aria-hidden="true" tabindex="-1"></a>    <span class="at">pred_high =</span> <span class="fu">quantile</span>(theta_new, <span class="fl">0.975</span>)</span>
<span id="cb4-371"><a href="#cb4-371" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-372"><a href="#cb4-372" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-373"><a href="#cb4-373" aria-hidden="true" tabindex="-1"></a>pi_all <span class="ot">&lt;-</span> <span class="fu">summarise_pred</span>(draws_all)</span>
<span id="cb4-374"><a href="#cb4-374" aria-hidden="true" tabindex="-1"></a>pi_1   <span class="ot">&lt;-</span> <span class="fu">summarise_pred</span>(draws_1)</span>
<span id="cb4-375"><a href="#cb4-375" aria-hidden="true" tabindex="-1"></a>pi_2   <span class="ot">&lt;-</span> <span class="fu">summarise_pred</span>(draws_2)</span>
<span id="cb4-376"><a href="#cb4-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-377"><a href="#cb4-377" aria-hidden="true" tabindex="-1"></a><span class="co"># ---- Build plotting rows with exact order ----</span></span>
<span id="cb4-378"><a href="#cb4-378" aria-hidden="true" tabindex="-1"></a><span class="co"># Desired order from TOP to BOTTOM:</span></span>
<span id="cb4-379"><a href="#cb4-379" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Subgroup "1500-3000": its studies (top), then "1500-3000 Pooled", then "1500-3000 Predicted"</span></span>
<span id="cb4-380"><a href="#cb4-380" aria-hidden="true" tabindex="-1"></a><span class="co">#    then a GAP</span></span>
<span id="cb4-381"><a href="#cb4-381" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Subgroup "&gt;3000":     its studies, then "&gt;3000 Pooled", then "&gt;3000 Predicted"</span></span>
<span id="cb4-382"><a href="#cb4-382" aria-hidden="true" tabindex="-1"></a><span class="co">#    then a GAP</span></span>
<span id="cb4-383"><a href="#cb4-383" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Overall:              "Overall Pooled", then "Overall Predicted" (very bottom)</span></span>
<span id="cb4-384"><a href="#cb4-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-385"><a href="#cb4-385" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper to make study rows</span></span>
<span id="cb4-386"><a href="#cb4-386" aria-hidden="true" tabindex="-1"></a>make_study_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(dsub, label_group) {</span>
<span id="cb4-387"><a href="#cb4-387" aria-hidden="true" tabindex="-1"></a>  dsub <span class="sc">%&gt;%</span></span>
<span id="cb4-388"><a href="#cb4-388" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb4-389"><a href="#cb4-389" aria-hidden="true" tabindex="-1"></a>      <span class="at">lab   =</span> <span class="fu">paste0</span>(study, <span class="st">" ("</span>, label_group, <span class="st">")"</span>),</span>
<span id="cb4-390"><a href="#cb4-390" aria-hidden="true" tabindex="-1"></a>      <span class="at">type  =</span> <span class="st">"study"</span>,</span>
<span id="cb4-391"><a href="#cb4-391" aria-hidden="true" tabindex="-1"></a>      <span class="at">xmin  =</span> lower, <span class="at">x =</span> yi, <span class="at">xmax =</span> upper,</span>
<span id="cb4-392"><a href="#cb4-392" aria-hidden="true" tabindex="-1"></a>      <span class="at">col   =</span> <span class="st">"#1f77b4"</span>, <span class="at">shape =</span> <span class="cn">NA_real_</span></span>
<span id="cb4-393"><a href="#cb4-393" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb4-394"><a href="#cb4-394" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(lab, type, xmin, x, xmax, col, shape)</span>
<span id="cb4-395"><a href="#cb4-395" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-396"><a href="#cb4-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-397"><a href="#cb4-397" aria-hidden="true" tabindex="-1"></a><span class="co"># Helper to make pooled + predicted rows (in that order)</span></span>
<span id="cb4-398"><a href="#cb4-398" aria-hidden="true" tabindex="-1"></a>make_summary_rows <span class="ot">&lt;-</span> <span class="cf">function</span>(summ, pi, label_group) {</span>
<span id="cb4-399"><a href="#cb4-399" aria-hidden="true" tabindex="-1"></a>  pooled <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-400"><a href="#cb4-400" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab   =</span> <span class="fu">paste0</span>(label_group, <span class="st">" Pooled"</span>),</span>
<span id="cb4-401"><a href="#cb4-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">type  =</span> <span class="st">"pooled"</span>,</span>
<span id="cb4-402"><a href="#cb4-402" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin  =</span> summ<span class="sc">$</span>mu_low, <span class="at">x =</span> summ<span class="sc">$</span>mu_median, <span class="at">xmax =</span> summ<span class="sc">$</span>mu_high,</span>
<span id="cb4-403"><a href="#cb4-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">col   =</span> <span class="st">"darkred"</span>, <span class="at">shape =</span> <span class="dv">15</span></span>
<span id="cb4-404"><a href="#cb4-404" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-405"><a href="#cb4-405" aria-hidden="true" tabindex="-1"></a>  predicted <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-406"><a href="#cb4-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">lab   =</span> <span class="fu">paste0</span>(label_group, <span class="st">" Predicted"</span>),</span>
<span id="cb4-407"><a href="#cb4-407" aria-hidden="true" tabindex="-1"></a>    <span class="at">type  =</span> <span class="st">"predicted"</span>,</span>
<span id="cb4-408"><a href="#cb4-408" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin  =</span> pi<span class="sc">$</span>pred_low, <span class="at">x =</span> summ<span class="sc">$</span>mu_median, <span class="at">xmax =</span> pi<span class="sc">$</span>pred_high,</span>
<span id="cb4-409"><a href="#cb4-409" aria-hidden="true" tabindex="-1"></a>    <span class="at">col   =</span> <span class="st">"orange"</span>, <span class="at">shape =</span> <span class="dv">17</span></span>
<span id="cb4-410"><a href="#cb4-410" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-411"><a href="#cb4-411" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(pooled, predicted)</span>
<span id="cb4-412"><a href="#cb4-412" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-413"><a href="#cb4-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-414"><a href="#cb4-414" aria-hidden="true" tabindex="-1"></a>rows_top_to_bottom <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">bind_rows</span>(</span>
<span id="cb4-415"><a href="#cb4-415" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subgroup 1500–3000 block</span></span>
<span id="cb4-416"><a href="#cb4-416" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_study_rows</span>(df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"1500-3000"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(study)), <span class="st">"1500-3000"</span>),</span>
<span id="cb4-417"><a href="#cb4-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_summary_rows</span>(summ_1, pi_1, <span class="st">"1500-3000"</span>),</span>
<span id="cb4-418"><a href="#cb4-418" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">lab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"gap"</span>, <span class="at">xmin =</span> <span class="cn">NA</span>, <span class="at">x =</span> <span class="cn">NA</span>, <span class="at">xmax =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">shape =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb4-419"><a href="#cb4-419" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-420"><a href="#cb4-420" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Subgroup &gt;3000 block</span></span>
<span id="cb4-421"><a href="#cb4-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_study_rows</span>(df <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(group <span class="sc">==</span> <span class="st">"&gt;3000"</span>) <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">arrange</span>(dplyr<span class="sc">::</span><span class="fu">desc</span>(study)), <span class="st">"&gt;3000"</span>),</span>
<span id="cb4-422"><a href="#cb4-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_summary_rows</span>(summ_2, pi_2, <span class="st">"&gt;3000"</span>),</span>
<span id="cb4-423"><a href="#cb4-423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">lab =</span> <span class="st">""</span>, <span class="at">type =</span> <span class="st">"gap"</span>, <span class="at">xmin =</span> <span class="cn">NA</span>, <span class="at">x =</span> <span class="cn">NA</span>, <span class="at">xmax =</span> <span class="cn">NA</span>, <span class="at">col =</span> <span class="cn">NA</span>, <span class="at">shape =</span> <span class="cn">NA_real_</span>),</span>
<span id="cb4-424"><a href="#cb4-424" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-425"><a href="#cb4-425" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Overall at very bottom: pooled then predicted</span></span>
<span id="cb4-426"><a href="#cb4-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">make_summary_rows</span>(summ_all, pi_all, <span class="st">"Overall"</span>)</span>
<span id="cb4-427"><a href="#cb4-427" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-428"><a href="#cb4-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-429"><a href="#cb4-429" aria-hidden="true" tabindex="-1"></a>rows_top_to_bottom <span class="ot">&lt;-</span> rows_top_to_bottom <span class="sc">%&gt;%</span></span>
<span id="cb4-430"><a href="#cb4-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">row_id =</span> dplyr<span class="sc">::</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb4-431"><a href="#cb4-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">y =</span> <span class="fu">rev</span>(row_id))</span>
<span id="cb4-432"><a href="#cb4-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-433"><a href="#cb4-433" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-434"><a href="#cb4-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-435"><a href="#cb4-435" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(rows_top_to_bottom, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x)) <span class="sc">+</span></span>
<span id="cb4-436"><a href="#cb4-436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"study"</span>),</span>
<span id="cb4-437"><a href="#cb4-437" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), <span class="at">height =</span> <span class="fl">0.2</span>,</span>
<span id="cb4-438"><a href="#cb4-438" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"#1f77b4"</span>) <span class="sc">+</span></span>
<span id="cb4-439"><a href="#cb4-439" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"study"</span>),</span>
<span id="cb4-440"><a href="#cb4-440" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">"#1f77b4"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb4-441"><a href="#cb4-441" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"pooled"</span>),</span>
<span id="cb4-442"><a href="#cb4-442" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), <span class="at">height =</span> <span class="fl">0.3</span>,</span>
<span id="cb4-443"><a href="#cb4-443" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb4-444"><a href="#cb4-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"pooled"</span>),</span>
<span id="cb4-445"><a href="#cb4-445" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">shape =</span> <span class="fu">factor</span>(shape)), <span class="at">color =</span> <span class="st">"darkred"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb4-446"><a href="#cb4-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbarh</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"predicted"</span>),</span>
<span id="cb4-447"><a href="#cb4-447" aria-hidden="true" tabindex="-1"></a>                 <span class="fu">aes</span>(<span class="at">xmin =</span> xmin, <span class="at">xmax =</span> xmax), <span class="at">height =</span> <span class="fl">0.3</span>,</span>
<span id="cb4-448"><a href="#cb4-448" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="fl">1.1</span>) <span class="sc">+</span></span>
<span id="cb4-449"><a href="#cb4-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"predicted"</span>),</span>
<span id="cb4-450"><a href="#cb4-450" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">shape =</span> <span class="fu">factor</span>(shape)), <span class="at">color =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb4-451"><a href="#cb4-451" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb4-452"><a href="#cb4-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"pooled"</span>),</span>
<span id="cb4-453"><a href="#cb4-453" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> xmax <span class="sc">+</span> <span class="dv">3</span>, <span class="at">y =</span> y, <span class="at">label =</span> <span class="st">"Pooled"</span>),</span>
<span id="cb4-454"><a href="#cb4-454" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb4-455"><a href="#cb4-455" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">data =</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(rows_top_to_bottom, type <span class="sc">==</span> <span class="st">"predicted"</span>),</span>
<span id="cb4-456"><a href="#cb4-456" aria-hidden="true" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> xmax <span class="sc">+</span> <span class="dv">3</span>, <span class="at">y =</span> y, <span class="at">label =</span> <span class="st">"Predicted"</span>),</span>
<span id="cb4-457"><a href="#cb4-457" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="dv">0</span>, <span class="at">size =</span> <span class="fl">3.2</span>) <span class="sc">+</span></span>
<span id="cb4-458"><a href="#cb4-458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(</span>
<span id="cb4-459"><a href="#cb4-459" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> rows_top_to_bottom<span class="sc">$</span>y,</span>
<span id="cb4-460"><a href="#cb4-460" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> rows_top_to_bottom<span class="sc">$</span>lab</span>
<span id="cb4-461"><a href="#cb4-461" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb4-462"><a href="#cb4-462" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">15</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">15</span>, <span class="st">`</span><span class="at">17</span><span class="st">`</span> <span class="ot">=</span> <span class="dv">17</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb4-463"><a href="#cb4-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb4-464"><a href="#cb4-464" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Mean difference"</span>, <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb4-465"><a href="#cb4-465" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Forest plot: CACs cores in male &amp; female athletes engaging in different volumes of exercise"</span>,</span>
<span id="cb4-466"><a href="#cb4-466" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">"Points and horizontal lines represent posterior medians and 95% credible intervals"</span>) <span class="sc">+</span></span>
<span id="cb4-467"><a href="#cb4-467" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-468"><a href="#cb4-468" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb4-469"><a href="#cb4-469" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb4-470"><a href="#cb4-470" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">13</span>, <span class="at">face =</span> <span class="st">"bold"</span>)</span>
<span id="cb4-471"><a href="#cb4-471" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-472"><a href="#cb4-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-473"><a href="#cb4-473" aria-hidden="true" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb4-474"><a href="#cb4-474" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/combined_forest_plot.png"</span>, p, <span class="at">width =</span> <span class="fl">7.5</span>, <span class="at">height =</span> <span class="fl">8.5</span>, <span class="at">dpi =</span> <span class="dv">300</span>)</span>
<span id="cb4-475"><a href="#cb4-475" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="st">"images/combined_forest_plot.pdf"</span>, p, <span class="at">width =</span> <span class="fl">7.5</span>, <span class="at">height =</span> <span class="fl">8.5</span>)</span>
<span id="cb4-476"><a href="#cb4-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-477"><a href="#cb4-477" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb4-478"><a href="#cb4-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-479"><a href="#cb4-479" aria-hidden="true" tabindex="-1"></a><span class="al">![](images/combined_forest_plot.png)</span></span>
<span id="cb4-480"><a href="#cb4-480" aria-hidden="true" tabindex="-1"></a>The plot shows mean difference = 3.6 (95% CI -10.3 to 16.5), with no evidence of a statistically significant difference.</span>
<span id="cb4-481"><a href="#cb4-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-482"><a href="#cb4-482" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusion</span></span>
<span id="cb4-483"><a href="#cb4-483" aria-hidden="true" tabindex="-1"></a>The original objective of the meta-analysis was to compare CAC scores in athletes versus nonathletes and while not reported in the final publication, this showed no meaningful differences. The authors reported only post hoc analyses according to sex and claim that "males with high-volume exercise training (&gt;3,000 MET-min/wk) exhibited a higher burden of calcified plaque by CAC score than male nonathletes". This is somewhat disengenous as there was no difference between lower level exercise training (1,500 - 3,000 MET-min/wk) and calcified plaque by CAC score compared to male nonathletes, nor was there any statistically significant difference when comparing the high amd low groups.       </span>
<span id="cb4-484"><a href="#cb4-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-485"><a href="#cb4-485" aria-hidden="true" tabindex="-1"></a>It is well known that positive results have a higher probability of being published and a cynical reader might wonder if the authors, aware of this, were simply looking for anything positive, or at least trending to positive, to report and found it by examining subgroups according to sex and level of exercise training. This is known as p-hacking, although the proper analysis did not find a statistically significant p value, and is a well recognized source of bias in the scientific literature.     </span>
<span id="cb4-486"><a href="#cb4-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-487"><a href="#cb4-487" aria-hidden="true" tabindex="-1"></a>Deviations from the preregistered protocol, ignoring prior evidence  of exercise benefits, and questionable statistical analyses weaken any  possible useful inferences from this study. What then is the legacy of the publication beyond adding to the authors' CVs?</span>
<span id="cb4-488"><a href="#cb4-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-489"><a href="#cb4-489" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">
<p>Powered by <a href="https://quarto.org">Quarto</a>.</p>
</div>   
    <div class="nav-footer-center">
<p>© 2025 Jay Brophy</p>
<div class="toc-actions"><ul><li><a href="https://github.com/brophyj/edit/main/posts/2025-11-27-Something_positive/index.Rmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/brophyj/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>License: <a href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY NC SA 4.0</a>.</p>
</div>
  </div>
</footer><script type="text/javascript">
const dateElements = document.querySelectorAll("p.date, div.listing-date, div.listing-file-modified");
dateElements.forEach((el) => {
  el.innerHTML = el.innerHTML.replace(
    /(\d+)(st|nd|rd|th)/g,
    "$1<sup style='font-size:0.5em;font-style:italic;'>$2</sup>"
  );
});
</script><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>