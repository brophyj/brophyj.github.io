{
  "hash": "f52268cb6d8a9deaf225fc21750f6b07",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Personal beliefs - An example from Colchicine - CLEAR OASIS\"\nauthor: \n  - name: Jay Brophy\n    affiliation: McGill University\ndate: 'December 30, 2024'\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\n    css: custom.scss\n  pdf:\n    toc: true\n    number-sections: true\n    colorlinks: true\neditor: visual\n---\n\n\n\n\n\n\n## Most recent trial\n\nIn the CLEAR OASIS 9 [trial](https://www.medpagetoday.com/meetingcoverage/tct/112644?xid=nl_mpt_Cardiology_update_2024-11-01&mh=5ea0ef63b494fbd59d59b80f4d7177fa&zdee=gAAAAABm4utWmSHJnY-b0PoghpwIdJ2Z5bp7pHCJbHd4lnSWdd-TcQH64qhAqr5vStSuTwshVLoWZmIfruyxrtdHQaON6GGWin0MsBBlzSgmQd4CbqGcFWQ%3D&utm_source=Sailthru&utm_medium=email&utm_campaign=Automated%20Specialty%20Update%20Cardiology%20BiWeekly%20FRIDAY%202024-11-01&utm_term=NL_Spec_Cardiology_Update_Active) acute MI patients were randomized to colchicine (n = 3,528) or placebo (n = 3,534) right after percutaneous coronary intervention (PCI).   \n\nThe primary outcome of major adverse CV events (MACE), composite of CV death, MI, stroke, or ischemia-driven revascularization, for colchicine vs. placebo at 5 years, was: 9.1% vs. 9.3%, hazard ratio (HR) 0.99 (95% confidence interval [CI] 0.85-1.16), p = 0.93.\n\nSecondary outcomes for colchicine vs. placebo at 5 years:     \n\nCV death: 3.3% vs. 3.2%, HR 1.03 (95% CI 0.80-1.34)     \nAll-cause death: 4.6% vs. 5.1%, HR 0.90 (95% CI 0.73-1.12)    \nMI: 2.9% vs. 3.1%, HR 0.88 (95% CI 0.66-1.17)    \nIschemia-driven revascularization: 4.6% vs. 4.7%, HR 1.01 (95% CI 0.81-1.17)    \nLSM C-reactive protein (CRP) levels at 3 months: 3.0 vs. 4.3 mg/dL, p < 0.001    \n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(cmdstanr)\nlibrary(bayesplot)\nlibrary(lme4)\n```\n:::\n\n\n\n\n\n\nThere was an interesting quote from the principal investigator (PI) who said that before this study \"\"I was a believer in colchicine\" but not a believer after the study. This dichotomization of beliefs is very common among physicians, perhaps influenced by the null hypothesis significance testing paradigm and the almighty p value that remain the cornerstone of most medical research.     \nLet's take a look at this from a probabilistic viewpoint.  \n\n## What is the prior evidence?\n\nThe PI stated before his trial was completed  he was a \"believer\", then what was his evidence to support this belief. Perhaps his belief was founded on the  on the results from the [COLCOT study](https://www.nejm.org/doi/10.1056/NEJMoa1912388?url_ver=Z39.88-2003&rfr_id=ori:rid:crossref.org&rfr_dat=cr_pub%20%200pubmed) where patients were randomized to the same dose of colchicine (n=2366) or placebo (n=2379) a mean of 13.5 days after their acute MI. The primary efficacy end point was a composite of death from cardiovascular causes, resuscitated cardiac arrest, myocardial infarction, stroke, or urgent hospitalization for angina leading to coronary revascularization. The primary end point occurred in 5.5% of the patients in the colchicine group, as compared with 7.1% of those in the placebo group (hazard ratio, 0.77; 95% confidence interval [CI], 0.61 to 0.96; P=0.02).       \nPresumably others didn't quite share his belief or the necessary equipoise would not have been present to proceed with the CLEAR OASIS 9 [trial](https://www.medpagetoday.com/meetingcoverage/tct/112644?xid=nl_mpt_Cardiology_update_2024-11-01&mh=5ea0ef63b494fbd59d59b80f4d7177fa&zdee=gAAAAABm4utWmSHJnY-b0PoghpwIdJ2Z5bp7pHCJbHd4lnSWdd-TcQH64qhAqr5vStSuTwshVLoWZmIfruyxrtdHQaON6GGWin0MsBBlzSgmQd4CbqGcFWQ%3D&utm_source=Sailthru&utm_medium=email&utm_campaign=Automated%20Specialty%20Update%20Cardiology%20BiWeekly%20FRIDAY%202024-11-01&utm_term=NL_Spec_Cardiology_Update_Active).        \n<br>\nA presentation of these results from a probabilistic viewpoint may help understand these discrepancies.\n\n## Bayesian view of the prior evidence \n\nLets' first write some `Stan` code for a two arm binomial trial with vague priors\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# stan code for 2 arm binomial\nstancode <- '\ndata {\n  int<lower=0> n1;  // Total number of trials in the placebo arm\n  int<lower=0> y1;  // Number of successes in the placebo arm\n  int<lower=0> n2;  // Total number of trials in the intervention arm\n  int<lower=0> y2;  // Number of successes in the intervention arm\n}\n\nparameters {\n  real<lower=0, upper=1> p1; // Probability of success in the placebo arm\n  real<lower=0, upper=1> p2; // Probability of success in the intervention arm\n}\n\nmodel {\n  p1 ~ beta(1, 1); // Default prior for p1\n  p2 ~ beta(1, 1); // Default prior for p2\n\n  y1 ~ binomial(n1, p1); // Likelihood for the placebo arm\n  y2 ~ binomial(n2, p2); // Likelihood for the intervention arm\n}\n\ngenerated quantities {\n  real rr = p2 / p1;  // Relative Risk of intervention arm over placebo arm\n}\n'\nwriteLines(stancode, \"binom_2.stan\")\n\n# check file exists\n# file.exists(\"binom_2.stan\")\n# cat(readLines(\"binom_2.stan\"), sep = \"\\n\")\n```\n:::\n\n\n\n\n\n\nNow will execute this program with the COLCOT data in order to fully appreciate the entire posterior probability distribution as opposed to be a limted fixed viewpoint of an uninteresting null hypothesis as is the conventional statistical approach.\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Data for the COLCOT model\ndata_list <- list(\n  n2 = 2366,\n  y2 = as.integer(2366 * 0.055),\n  n1 = 2379,\n  y1 = as.integer(2379 * 0.071)\n)\n\n# Compile and fit the model\nmod <- cmdstan_model(\"binom_2.stan\")\nfit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4,        refresh = 0, seed = 123)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRunning MCMC with 4 parallel chains...\n\nChain 1 finished in 0.0 seconds.\nChain 2 finished in 0.0 seconds.\nChain 3 finished in 0.0 seconds.\nChain 4 finished in 0.0 seconds.\n\nAll 4 chains finished successfully.\nMean chain execution time: 0.0 seconds.\nTotal execution time: 0.2 seconds.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extracting posterior samples\nposterior_samples <- fit$draws()\n\n# Plotting\ncolor_scheme_set(\"blue\")\n# mcmc_trace(posterior_samples, pars = c(\"p1\", \"p2\", \"rr\"), nrow = 3)\n\n# Plot relative risk distributions with no formatting\n# mcmc_areas(posterior_samples, pars = \"rr\", prob = 0.95)\n\n# print summary\nfit$summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 10\n  variable       mean    median      sd     mad       q5      q95  rhat ess_bulk\n  <chr>         <dbl>     <dbl>   <dbl>   <dbl>    <dbl>    <dbl> <dbl>    <dbl>\n1 lp__     -1117.      -1.12e+3 1.07    0.756   -1.12e+3 -1.12e+3  1.00    1916.\n2 p1           0.0711   7.09e-2 0.00535 0.00521  6.26e-2  8.03e-2  1.00    3368.\n3 p2           0.0553   5.51e-2 0.00477 0.00476  4.76e-2  6.35e-2  1.00    2737.\n4 rr           0.782    7.79e-1 0.0897  0.0864   6.43e-1  9.35e-1  1.00    3179.\n# ℹ 1 more variable: ess_tail <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Correct extraction of relative risk samples\nrr_samples <- fit$draws(variables = \"rr\")\nrr_vector <- as.vector(rr_samples)  # Convert to a simple vector for easier handling\n\n# Calculating probabilities\nprob_rr_less_09 <- mean(rr_vector < 0.9)\nprob_rr_between_09_11 <- mean(rr_vector >= 0.9 & rr_vector <= 1.1)\nprob_rr_greater_11 <- mean(rr_vector > 1.1)\nprob_rr_less_08 <- mean(rr_vector < 0.8)\nprob_rr_less_10 <- mean(rr_vector < 1.0)\n\n# Print the probabilities\ncat(\"Probability RR < 1.0 (P (statistical signifiance)): \", prob_rr_less_10, \n    \"\\nProbability RR < 0.8: \", prob_rr_less_08, \n    \"\\nProbability RR < 0.9: \", prob_rr_less_09,\n    \"\\nProbability RR 0.9 to 1.1: \", prob_rr_between_09_11, \n    \"\\nProbability RR > 1.1: \", prob_rr_greater_11, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProbability RR < 1.0 (P (statistical signifiance)):  0.9865 \nProbability RR < 0.8:  0.5985 \nProbability RR < 0.9:  0.89975 \nProbability RR 0.9 to 1.1:  0.0985 \nProbability RR > 1.1:  0.00175 \n```\n\n\n:::\n:::\n\n\n\n\n\n\nThis may also be appreciated graphically\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming rr_vector is already defined\nd <- density(rr_vector)\ndensity_df <- data.frame(x = d$x, y = d$y)\n\n# Assign categories based on the x values\ndensity_df$category <- ifelse(density_df$x < 0.9, \"benefit\",\n                              ifelse(density_df$x <= 1.1, \"equivalence\", \"harm\"))\n\np <- ggplot(density_df, aes(x = x, y = y)) +\n  geom_area(data = subset(density_df, category == \"benefit\"), fill = \"green\", alpha = 0.5) +\n  geom_area(data = subset(density_df, category == \"equivalence\"), fill = \"yellow\", alpha = 0.5) +\n  geom_area(data = subset(density_df, category == \"harm\"), fill = \"red\", alpha = 0.5) +\n  geom_vline(xintercept = 0.9, linetype = \"dashed\", color = \"black\") +\n  geom_vline(xintercept = 1.1, linetype = \"dashed\", color = \"black\") +\n  labs(title=\"Density Plot of Relative Risk based on COLCOT\",\n       subtitle = \"with a vague prior\") +\n  theme_classic() +\n  scale_x_continuous(expand = c(0, 0)) +  # No expansion on x-axis\n  scale_y_continuous(expand = c(0, 0)) +  # No expansion on y-axis\n  xlab(\"Relative Risk\") +\n  ylab(\"Density\")\n\np <- p + \n  annotate(\"text\", x = 0.64, y = max(density_df$y, na.rm = TRUE) * 0.8, label = \"Green\", color = \"green\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = 0.79, y = max(density_df$y, na.rm = TRUE) * 0.73, label = \" = region of clinical benefit\", color = \"black\", size = 5) +\n  annotate(\"text\", x = 0.9, y = max(density_df$y, na.rm = TRUE) * 0.6, label = \"Yellow\", color = \"yellow\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = 1.05, y = max(density_df$y, na.rm = TRUE) * 0.53, label = \" = region of practical equivalence\", color = \"black\", size = 5) +\n  annotate(\"text\", x = 1.15, y = max(density_df$y, na.rm = TRUE) * 0.4, label = \"Red\", color = \"red\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = 1.10, y = max(density_df$y, na.rm = TRUE) * 0.35, label = \" = region of clinical harm\", color = \"black\", size = 5)\n\np\n```\n\n::: {.cell-output-display}\n![](Colchicine_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nThis figure explains why there may be different beliefs about the colchicine effect with some being enthusiastic about a 90% probability of a clinical benefit (assuming a 10% reduction in RR is an appropriate clinical threshold). Conversely others may be more conservative and want a larger reduction in RR, given the inconvenience and costs of taking another medication. The probability of an at least 20% reduction is only 60% underscoring the need for some to await further studies to better define any clinical benefits. \n\n## Bayesian approach with Stan \n\nFor the current CLEAR OASIS results, initially let's assume a vague priors so that the posterior probability distribution is completely dominated by the current data. We will estimate the probabilities for each arm and their relative risk (RR). From the RR posterior probability density one can further calculate probabilities for various cutpoints. For example, one might assume that we are particularly interested in probabilities that exceed a clinically meaningful benefit or harm. These cutpoints can be individually chosen but let's again assume a benefit threshold of RR < 0.9 and harm threshold of RR > 1.1.\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(cmdstanr)\nlibrary(bayesplot)\n\n\n# Data for the model\ndata_list <- list(\n  n2 = 3528,\n  y2 = as.integer(3528 * 0.091),\n  n1 = 3534,\n  y1 = as.integer(3534 * 0.093)\n)\n\n# Compile and fit the model\nmod <- cmdstan_model(\"binom_2.stan\")\nfit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4,        refresh = 0, seed = 123)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRunning MCMC with 4 parallel chains...\n\nChain 1 finished in 0.0 seconds.\nChain 2 finished in 0.0 seconds.\nChain 3 finished in 0.0 seconds.\nChain 4 finished in 0.0 seconds.\n\nAll 4 chains finished successfully.\nMean chain execution time: 0.0 seconds.\nTotal execution time: 0.2 seconds.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extracting posterior samples\nposterior_samples <- fit$draws()\n\n# Plotting\ncolor_scheme_set(\"blue\")\nmcmc_trace(posterior_samples, pars = c(\"p1\", \"p2\", \"rr\"), nrow = 3)\n```\n\n::: {.cell-output-display}\n![](Colchicine_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot relative risk distributions with no formatting\n# mcmc_areas(posterior_samples, pars = \"rr\", prob = 0.95)\n\n# print summary\nfit$summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 10\n  variable       mean    median      sd     mad       q5      q95  rhat ess_bulk\n  <chr>         <dbl>     <dbl>   <dbl>   <dbl>    <dbl>    <dbl> <dbl>    <dbl>\n1 lp__     -2173.      -2.17e+3 0.998   0.719   -2.18e+3 -2.17e+3  1.00    1715.\n2 p1           0.0931   9.29e-2 0.00487 0.00494  8.52e-2  1.01e-1  1.00    3788.\n3 p2           0.0914   9.13e-2 0.00488 0.00484  8.36e-2  9.95e-2  1.00    2400.\n4 rr           0.985    9.82e-1 0.0734  0.0729   8.67e-1  1.11e+0  1.00    2532.\n# ℹ 1 more variable: ess_tail <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Correct extraction of relative risk samples\nrr_samples <- fit$draws(variables = \"rr\")\nrr_vector <- as.vector(rr_samples)  # Convert to a simple vector for easier handling\n\n# Calculating probabilities\nprob_rr_less_09 <- mean(rr_vector < 0.9)\nprob_rr_between_09_11 <- mean(rr_vector >= 0.9 & rr_vector <= 1.1)\nprob_rr_greater_11 <- mean(rr_vector > 1.1)\n\n# Print the probabilities\ncat(\"Probability RR < 0.9: \", prob_rr_less_09, \"\\nProbability RR 0.9 to 1.1: \", prob_rr_between_09_11, \"\\nProbability RR > 1.1: \", prob_rr_greater_11, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProbability RR < 0.9:  0.122 \nProbability RR 0.9 to 1.1:  0.8125 \nProbability RR > 1.1:  0.0655 \n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Graphical presentation\n\nUnderstanding these results is again facilitated with graphical presentations\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming rr_vector is already defined\nd <- density(rr_vector)\ndensity_df <- data.frame(x = d$x, y = d$y)\n\n# Assign categories based on the x values\ndensity_df$category <- ifelse(density_df$x < 0.9, \"benefit\",\n                              ifelse(density_df$x <= 1.1, \"equivalence\", \"harm\"))\n\np <- ggplot(density_df, aes(x = x, y = y)) +\n  geom_area(data = subset(density_df, category == \"benefit\"), fill = \"green\", alpha = 0.5) +\n  geom_area(data = subset(density_df, category == \"equivalence\"), fill = \"yellow\", alpha = 0.5) +\n  geom_area(data = subset(density_df, category == \"harm\"), fill = \"red\", alpha = 0.5) +\n  geom_vline(xintercept = 0.9, linetype = \"dashed\", color = \"black\") +\n  geom_vline(xintercept = 1.1, linetype = \"dashed\", color = \"black\") +\n  labs(title=\"Density Plot of Relative Risk based on CLEAR OASIS\",\n       subtitle = \"with a vague prior\") +\n  theme_classic() +\n  scale_x_continuous(expand = c(0, 0)) +  # No expansion on x-axis\n  scale_y_continuous(expand = c(0, 0)) +  # No expansion on y-axis\n  xlab(\"Relative Risk\") +\n  ylab(\"Density\")\n\np <- p + \n  annotate(\"text\", x = 0.80, y = max(density_df$y, na.rm = TRUE) * 0.6, label = \"Green\", color = \"green\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = 0.89, y = max(density_df$y, na.rm = TRUE) * 0.57, label = \" = region of clinical benefit\", color = \"black\", size = 5) +\n  annotate(\"text\", x = 0.8, y = max(density_df$y, na.rm = TRUE) * 0.8, label = \"Yellow\", color = \"yellow\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = .92, y = max(density_df$y, na.rm = TRUE) * 0.77, label = \" = region of practical equivalence\", color = \"black\", size = 5) +\n  annotate(\"text\", x = 1.1, y = max(density_df$y, na.rm = TRUE) * 0.4, label = \"Red\", color = \"red\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = 1.19, y = max(density_df$y, na.rm = TRUE) * 0.37, label = \" = region of clinical harm\", color = \"black\", size = 5)\n\np\n```\n\n::: {.cell-output-display}\n![](Colchicine_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nThis analysis shows that there is only a small probability (12%) of a clinically significant benefit (where this has been arbitrarily defined as a minimum 10% decrease in RR). There is a 7% of clinical harm (RR >1.1) and a 81% probability of practical equivalence.  \n<br>\nRecall that this analysis examines only the current study but the lead PI claimed he was a priori a \"believer\" so to be consistent with this prior belief, this posterior belief based on a vague prior should be replaced with an informative prior belief that is updated with this new data.   \n<br>\nThis infromative prior is combined with the current data following the laws of probability, i.e. a weighted average according with weights proportional to the precision of the prior and current data\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# stan code for 2 arm binomial with informative prior\nstancode <- '\ndata {\n  int<lower=0> n1;  // Total number of trials in the placebo arm\n  int<lower=0> y1;  // Number of successes in the placebo arm\n  int<lower=0> n2;  // Total number of trials in the intervention arm\n  int<lower=0> y2;  // Number of successes in the intervention arm\n  real<lower=0> alpha1; // Alpha for beta prior on p1\n  real<lower=0> beta1;  // Beta for beta prior on p1\n  real<lower=0> alpha2; // Alpha for beta prior on p2\n  real<lower=0> beta2;  // Beta for beta prior on p2\n}\n\nparameters {\n  real<lower=0, upper=1> p1; // Probability of success in the placebo arm\n  real<lower=0, upper=1> p2; // Probability of success in the intervention arm\n}\n\nmodel {\n  p1 ~ beta(alpha1, beta1); // Informative prior for p1 based on COLCOT\n  p2 ~ beta(alpha2, beta2); // Informative prior for p2 based on COLCOT\n\n  y1 ~ binomial(n1, p1); // Likelihood for the placebo arm\n  y2 ~ binomial(n2, p2); // Likelihood for the intervention arm\n}\n\ngenerated quantities {\n  real rr = p2 / p1;  // Relative Risk of intervention arm over placebo arm\n}'\nwriteLines(stancode, \"binom_2_priorCOLCOT.stan\")\n# file.exists(\"binom_2_priorCOLCOT.stan\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# prior from COLCOT\n\nalpha1 = as.integer(2379 * 0.071)\nbeta1 <- 2379 - alpha1\nalpha2 = as.integer(2366 * 0.055)\nbeta2 <- 2366 - alpha2\n\n# Data for the model\ndata_list <- list(\n  n1 = 3534,\n  y1 = as.integer(3534 * 0.093),\n  n2 = 3528,\n  y2 = as.integer(3528 * 0.091),\n  alpha1 = alpha1,\n  beta1 = beta1,\n  alpha2 = alpha2,\n  beta2 = beta2\n)\n\n\n# Compile and fit the model\nmod <- cmdstan_model(\"binom_2_priorCOLCOT.stan\")\nfit <- mod$sample(data = data_list, chains = 4, parallel_chains = 4,        refresh = 0, seed = 123)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRunning MCMC with 4 parallel chains...\n\nChain 1 finished in 0.0 seconds.\nChain 2 finished in 0.0 seconds.\nChain 3 finished in 0.0 seconds.\nChain 4 finished in 0.0 seconds.\n\nAll 4 chains finished successfully.\nMean chain execution time: 0.0 seconds.\nTotal execution time: 0.2 seconds.\n```\n\n\n:::\n\n```{.r .cell-code}\n# Extracting posterior samples\nposterior_samples <- fit$draws()\n\n# Plotting\ncolor_scheme_set(\"blue\")\nmcmc_trace(posterior_samples, pars = c(\"p1\", \"p2\", \"rr\"), nrow = 3)\n```\n\n::: {.cell-output-display}\n![](Colchicine_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot relative risk distributions with no formatting\n# mcmc_areas(posterior_samples, pars = \"rr\", prob = 0.95)\n\n# print summary\nfit$summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 4 × 10\n  variable       mean    median      sd     mad       q5      q95  rhat ess_bulk\n  <chr>         <dbl>     <dbl>   <dbl>   <dbl>    <dbl>    <dbl> <dbl>    <dbl>\n1 lp__     -3297.      -3.30e+3 1.02    0.749   -3.30e+3 -3.30e+3  1.00    1896.\n2 p1           0.0839   8.38e-2 0.00370 0.00367  7.80e-2  9.01e-2  1.00    3545.\n3 p2           0.0765   7.65e-2 0.00349 0.00341  7.08e-2  8.22e-2  1.00    3455.\n4 rr           0.913    9.13e-1 0.0576  0.0590   8.21e-1  1.01e+0  1.00    3283.\n# ℹ 1 more variable: ess_tail <dbl>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Correct extraction of relative risk samples\nrr_samples <- fit$draws(variables = \"rr\")\nrr_vector <- as.vector(rr_samples)  # Convert to a simple vector for easier handling\n\n# Calculating probabilities\nprob_rr_less_09 <- mean(rr_vector < 0.9)\nprob_rr_between_09_11 <- mean(rr_vector >= 0.9 & rr_vector <= 1.1)\nprob_rr_greater_11 <- mean(rr_vector > 1.1)\n\n# Print the probabilities\ncat(\"Probability RR < 0.9: \", prob_rr_less_09, \"\\nProbability RR 0.9 to 1.1: \", prob_rr_between_09_11, \"\\nProbability RR > 1.1: \", prob_rr_greater_11, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nProbability RR < 0.9:  0.41925 \nProbability RR 0.9 to 1.1:  0.5795 \nProbability RR > 1.1:  0.00125 \n```\n\n\n:::\n:::\n\n\n\n\n\n\n## Graphical presentation\n\nUnderstanding these results is facilitated with graphical presentations\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Assuming rr_vector is already defined\nd <- density(rr_vector)\ndensity_df <- data.frame(x = d$x, y = d$y)\n\n# Assign categories based on the x values\ndensity_df$category <- ifelse(density_df$x < 0.9, \"benefit\",\n                              ifelse(density_df$x <= 1.1, \"equivalence\", \"harm\"))\n\np <- ggplot(density_df, aes(x = x, y = y)) +\n  geom_area(data = subset(density_df, category == \"benefit\"), fill = \"green\", alpha = 0.5) +\n  geom_area(data = subset(density_df, category == \"equivalence\"), fill = \"yellow\", alpha = 0.5) +\n  geom_area(data = subset(density_df, category == \"harm\"), fill = \"red\", alpha = 0.5) +\n  geom_vline(xintercept = 0.9, linetype = \"dashed\", color = \"black\") +\n  geom_vline(xintercept = 1.1, linetype = \"dashed\", color = \"black\") +\n  labs(title=\"Density Plot of Relative Risk based on CLEAR OASIS\",\n       subtitle = \"with an informative (COLCOT) prior\") +\n  theme_classic() +\n  scale_x_continuous(expand = c(0, 0)) +  # No expansion on x-axis\n  scale_y_continuous(expand = c(0, 0)) +  # No expansion on y-axis\n  xlab(\"Relative Risk\") +\n  ylab(\"Density\")\n\np <- p + \n  annotate(\"text\", x = 0.80, y = max(density_df$y, na.rm = TRUE) * 0.6, label = \"Green\", color = \"green\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = 0.86, y = max(density_df$y, na.rm = TRUE) * 0.56, label = \" = region of clinical benefit\", color = \"black\", size = 5) +\n  annotate(\"text\", x = 0.8, y = max(density_df$y, na.rm = TRUE) * 0.8, label = \"Yellow\", color = \"yellow\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = .90, y = max(density_df$y, na.rm = TRUE) * 0.76, label = \" = region of practical equivalence\", color = \"black\", size = 5) +\n  annotate(\"text\", x = 1.00, y = max(density_df$y, na.rm = TRUE) * 0.4, label = \"Red\", color = \"red\", size = 5, fontface = \"bold\") +\n  annotate(\"text\", x = 1.07, y = max(density_df$y, na.rm = TRUE) * 0.33, label = \" = region of clinical harm\", color = \"black\", size = 5)\n\np\n```\n\n::: {.cell-output-display}\n![](Colchicine_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\nThe PI who was a \"believer\" prior to his study now claims after the study to be a non-believer (to the extent that he apparently stopped the medication that was previously prescribed to his father). Yet based on his positive prior beliefs (if these can be approximated by the COLCOT RCT positive result) there is a suggestion that there  remains a 42% probability of a clinically meaningful decrease in CV risk with colchicine, a 58% probability of clinical equivalence with placebo and no probability of increased cardiovascular outcomes.       \nMany clinicians do seem overly influenced by the last trial, particularly if they were intimately involved in it.  \n<br>\nThis of course does not imply that I  would prescribe colchicine for this condition as any decision should also consider cost, other side effects, and patient preferences incuding there personalized choices about what represents a clinically meaningful thresholds.    \n<br>\nFor the current PI to now be a disbeliever, perhaps his cutpoint for efficacy was RR < 0.80 and indeed this posterior probability is indeed very small. However this would imply that his prior efficacy belief based on COLCOT should also be based on the a probability of RR < 0.80 which was only 60%. This seems a fairly modest probability to have been a strong \"believer\" in this therapy before the current study. The reconciliation of these different beliefs is somewhat difficult.    \n<br>\nMy main point is dichotomizing beliefs is about as useful as the dichotomization of p values according to < or > 0.05,     \n[**IOW not very useful at all.**]{style=\"color: red\"}.        \n<br>\nBayesian reasoning can help avoid the cognitive difficulties that are often present in interpreting recent RCTs, especially in the context of previous knowledge.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}